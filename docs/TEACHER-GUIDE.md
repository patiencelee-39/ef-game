<a id="top"></a>

# 📚 教師修改指南

**遊戲名稱**：3-6歲聽障學齡前幼兒執行功能訓練遊戲  
**文件版本**：v1.2（2026/02/24）  
**適用對象**：教師 ／ 研究者 ／ 程式零基礎但想修改的人  
**目的**：讓非工程背景的人也能安全地修改遊戲設定

### 本指南適合誰？

| 身分 | 建議閱讀章節 |
| ---- | ------------ |
| 🍎 **教師** — 想改文字、場地名稱、遊戲參數 | 第 1–10 章（全部） |
| 🔰 **零基礎** — 完全沒碰過程式碼 | 先讀 **[零基礎入門](#零基礎入門)**，再讀第 1–10 章 |
| 🔬 **研究者** — 需要調整實驗參數、匯出數據 | 第 1–10 章 ＋ **[研究者進階](#研究者進階)** |

---

> 🔀 **快速切換**：[📄 完整需求文件 v4.5](完整需求文件v4.5.md#top) · [🛠️ 開發規範與工具](開發規範與工具.md#top) · [🔝 回到目錄](#目錄)

<a id="目錄"></a>

## 📖 目錄

0. [🔰 零基礎入門](#零基礎入門)  ← *沒碰過程式碼？從這裡開始*
1. [修改前必讀](#修改前必讀)
2. [我可以改什麼？（總覽表）](#我可以改什麼)
3. [檔案 1：遊戲數字設定（game-config.js）](#檔案1遊戲數字設定)
4. [檔案 2：場地對照表（combo-selector.js）](#檔案2場地對照表)
5. [檔案 3：顏色與字體（base.css）](#檔案3顏色與字體)
6. [檔案 4：首頁文字（home.html）](#檔案4首頁文字)
7. [檔案 5：故事對話文字（content/stories/）](#檔案5故事對話文字)
8. [量表評估功能（TC-CHEXI）](#量表評估功能)
9. [修改步驟教學](#修改步驟教學)
10. [常見問題 FAQ](#常見問題-faq)
11. [🔬 研究者進階](#研究者進階)  ← *實驗參數、自適應引擎、資料匯出*

---

<a id="零基礎入門"></a>

## 🔰 0. 零基礎入門

> 已經知道 HTML / CSS / JSON 是什麼？可以直接跳到 [第 1 章：修改前必讀](#修改前必讀)。

### 程式碼檔案就是「純文字檔」

遊戲的所有內容都存在一堆**純文字檔案**裡，用任何文字編輯器就能打開和修改。你不需要「會寫程式」，只需要找到對的位置、改掉文字或數字。

### 你會遇到的三種檔案類型

| 副檔名 | 中文名 | 長什麼樣子 | 你要改什麼 |
| ------ | ------ | ---------- | ---------- |
| `.html` | 網頁檔 | `<h1>遊戲名稱</h1>` | 改 `< >` 標籤**之間**的中文字 |
| `.css` | 樣式檔 | `font-size: 24px;` | 改 `:` 和 `;` **之間**的數字 |
| `.js` | 程式檔 | `DEFAULT_COUNT: 6,` | 改 `:` 和 `,` **之間**的數字 |
| `.json` | 資料檔 | `"text": "記住指示"` | 改 `"` 和 `"` **之間**的中文字 |

### 推薦工具：VS Code（免費）

1. 下載安裝 [Visual Studio Code](https://code.visualstudio.com/)
2. 打開 VS Code → **File → Open Folder** → 選擇遊戲專案資料夾
3. 左邊欄會出現所有檔案，點擊就能打開

### 最重要的四個快捷鍵

| 功能 | Mac | Windows |
| ---- | --- | ------- |
| 🔍 搜尋文字 | `Cmd + F` | `Ctrl + F` |
| 💾 存檔 | `Cmd + S` | `Ctrl + S` |
| ↩️ 復原（改壞了按這個） | `Cmd + Z` | `Ctrl + Z` |
| 🔄 全專案搜尋 | `Cmd + Shift + F` | `Ctrl + Shift + F` |

### 改壞了怎麼辦？

1. **還沒存檔** → 按 `Cmd+Z`（Mac）或 `Ctrl+Z`（Windows）一直按到恢復
2. **已經存檔** → 在 VS Code 左側欄找到「Source Control」圖示（分岔的線），對該檔案右鍵 → **Discard Changes**
3. **完全搞亂了** → 不要慌，聯絡開發者幫你還原

### 修改範例：改遊戲名稱（5 分鐘上手）

1. 用 VS Code 打開專案資料夾
2. 左邊點開 `home.html`
3. 按 `Cmd+F`，搜尋「執行功能訓練遊戲」
4. 把它改成你想要的名稱，例如「我的超棒遊戲」
5. 按 `Cmd+S` 存檔
6. 在瀏覽器重新整理就能看到效果！

> ✅ 恭喜！你已經完成第一次程式碼修改了。接下來的章節會告訴你「還能改什麼」以及「怎麼改」。

[🔝 回到目錄](#目錄)

---

<a id="修改前必讀"></a>

## ⚠️ 1. 修改前必讀

### 三條安全規則

1. **只改數字和中文文字** — 不要動英文名稱、符號（`{ } , : ;`）
2. **先備份、再修改** — 修改前先複製一份原檔案
3. **改完先測試** — 在測試環境確認效果，再上線

### 怎麼找到可以改的地方？

在程式碼中尋找這些標記：

| 標記            | 意思                           |
| --------------- | ------------------------------ |
| `🎓 教師可調區` | 這個區塊裡面有教師可以改的內容 |
| `← 教師可改`    | 這一行的數字或文字可以修改     |
| `⚠️ 請勿修改`   | 這裡千萬不要動！               |

[🔝 回到目錄](#目錄) · [📄 需求文件](完整需求文件v4.5.md#top) · [🛠️ 開發規範](開發規範與工具.md#top)

---

<a id="我可以改什麼"></a>

## 🔍 2. 我可以改什麼？（總覽表）

### 遊戲數字（在 `js/game-config.js`）

| 我想改的         | 設定名稱                   | 目前值        | 建議範圍    |
| ---------------- | -------------------------- | ------------- | ----------- |
| 圖片顯示多久     | `STIMULUS_DURATION_MS`     | 2000（2秒）   | 1000～5000  |
| 圖片間隔最短     | `ISI_MIN_MS`               | 800（0.8秒）  | 500～1500   |
| 圖片間隔最長     | `ISI_MAX_MS`               | 1200（1.2秒） | 800～2500   |
| 答對/錯提示時間  | `FEEDBACK_DURATION_MS`     | 800（0.8秒）  | 500～2000   |
| 開始倒數秒數     | `COUNTDOWN_SECONDS`        | 3             | 3～5        |
| 每場基本題數     | `DEFAULT_COUNT`            | 6             | 6～20       |
| 混合規則題數倍率 | `MIXED_MULTIPLIER`         | 2             | 2～3        |
| 最少可選題數     | `MIN_COUNT`                | 6             | 4～10       |
| 最多可選題數     | `MAX_COUNT`                | 30            | 20～50      |
| 通關門檻         | `PASS_THRESHOLD`           | 0.83（83%）   | 0.6～0.9    |
| 連續答對加分門檻 | `PERFECT_STREAK_THRESHOLD` | 5             | 3～10       |
| 工作記憶最少位置 | `MIN_POSITIONS`            | 2             | 2～3        |
| 工作記憶最多位置 | `MAX_POSITIONS`            | 6             | 4～9        |
| 位置亮起時間     | `HIGHLIGHT_DURATION_MS`    | 800（0.8秒）  | 500～1500   |
| 作答時間限制     | `RESPONSE_TIMEOUT_MS`      | 10000（10秒） | 5000～30000 |
| 逆向記憶機率     | `REVERSE_PROBABILITY`      | 0.5（50%）    | 0～1        |
| 最多幾人同時玩   | `MAX_PLAYERS`              | 8             | 2～12       |
| 通過規則得幾顆星 | `RULE_PASS_STAR`           | 1             | 1～5        |
| 開貼紙包花費     | `STICKER_PACK_COST`        | 3             | 1～10       |
| 換裝最低價       | `AVATAR_ITEM_COST_MIN`     | 5             | 1～10       |
| 換裝最高價       | `AVATAR_ITEM_COST_MAX`     | 15            | 10～30      |
| 餵寵物花費       | `PET_FEED_COST`            | 2             | 1～5        |

### 場地名稱和圖示（在 `js/shared/combo-selector.js`）

共 12 個場地，分為兩張地圖（🐭 小老鼠 6 關 + 🐟 釣魚 6 關），每張地圖含 3 種規則 × 有/無工作記憶：

| 場地 | 目前名稱          | 圖示 | 對應遊戲               | 難度   |
| ---- | ----------------- | ---- | ---------------------- | ------ |
| A    | 起司森林          | 🧀   | 🐭 小老鼠 · 規則一     | easy   |
| B    | 起司森林·記憶關   | 🧀   | 🐭 小老鼠 · 規則一+記憶 | easy   |
| C    | 貓咪廣場          | 😺   | 🐭 小老鼠 · 規則二     | medium |
| D    | 貓咪廣場·記憶關   | 😺   | 🐭 小老鼠 · 規則二+記憶 | medium |
| E    | 村莊奇遇          | 🏘️   | 🐭 小老鼠 · 混合規則   | hard   |
| F    | 村莊奇遇·記憶關   | 🏘️   | 🐭 小老鼠 · 混合+記憶   | hard   |
| G    | 珊瑚淺灘          | 🐟   | 🐟 釣魚 · 規則一       | easy   |
| H    | 珊瑚淺灘·記憶關   | 🐟   | 🐟 釣魚 · 規則一+記憶   | easy   |
| I    | 鯊魚灣            | 🦈   | 🐟 釣魚 · 規則二       | medium |
| J    | 鯊魚灣·記憶關     | 🦈   | 🐟 釣魚 · 規則二+記憶   | medium |
| K    | 潮汐深海          | 🌊   | 🐟 釣魚 · 混合規則     | hard   |
| L    | 潮汐深海·記憶關   | 🌊   | 🐟 釣魚 · 混合+記憶     | hard   |

### 遊戲場地文字（在 `js/game-config.js` → FIELDS 區）

| 場地      | 可改項目     | 目前值             |
| --------- | ------------ | ------------------ |
| 🐭 小老鼠 | 場地名稱     | 小老鼠遊戲場       |
| 🐭 小老鼠 | 場地圖示     | 🐭                 |
| 🐭 小老鼠 | 規則一名稱   | 規則一（建立規則） |
| 🐭 小老鼠 | 訓練目標文字 | 抑制控制           |
| 🐭 小老鼠 | 混合情境文字 | 沒人 / 有人        |
| 🐟 釣魚   | 場地名稱     | 釣魚遊戲場         |
| 🐟 釣魚   | 場地圖示     | 🐟                 |
| 🐟 釣魚   | 混合情境文字 | 白天 / 晚上        |

### 顏色（在 `css/themes/base.css`）

| 我想改的   | 設定名稱          | 目前色碼 | 目前顏色 |
| ---------- | ----------------- | -------- | -------- |
| 遊戲背景色 | `--bg-dark`       | #1a2332  | 深藍灰   |
| 主要文字色 | `--text-white`    | #ffffff  | 白色     |
| 主色調     | `--primary-blue`  | #3498db  | 藍色     |
| 答對提示色 | `--success-green` | #2ecc71  | 綠色     |
| 答錯提示色 | `--error-red`     | #e74c3c  | 紅色     |
| 強調色     | `--accent-yellow` | #ffd700  | 黃色     |
| 練習模式色 | `--practice-teal` | #1abc9c  | 青綠     |
| 工作記憶色 | `--wm-color`      | #5c6bc0  | 靛藍     |

> 💡 **怎麼選顏色？** Google 搜尋「HTML color picker」，用滑鼠選顏色就能得到色碼（如 #FF6B35）。

### 首頁文字（在 `home.html`）

> ⚠️ 注意：首頁是 `home.html`（不是 `index.html`）。`index.html` 是進站前的登入頁面。

| 可改項目   | 目前內容                                    |
| ---------- | ------------------------------------------- |
| 遊戲名稱   | 🎮 執行功能訓練遊戲                         |
| 副標題     | 選擇你想進行的模式                          |
| 模式卡片   | 🗺️ 單人冒險、⚔️ 多人競賽、🏆 排行榜、🐔 養雞場、📋 量表評估、⚙️ 設定 |
| 按鈕文字   | 開始冒險、進入競賽、查看排名、進入養雞場、前往填寫、前往設定 |
| 頁尾版權   | © 2026 執行功能訓練遊戲 &#124; 學術研究專案 |

[🔝 回到目錄](#目錄) · [📄 需求文件](完整需求文件v4.5.md#top) · [🛠️ 開發規範](開發規範與工具.md#top)

---

<a id="檔案1遊戲數字設定"></a>

## 📁 3. 檔案 1：遊戲數字設定

**檔案位置**：`js/game-config.js`

這是最重要的檔案！遊戲的時間、題數、分數、難度全部在這裡。

### 修改範例：讓圖片顯示更久

**需求**：覺得圖片出現太快，孩子來不及反應。

**步驟**：

1. 打開 `js/game-config.js`
2. 搜尋 `STIMULUS_DURATION_MS`（用 Ctrl+F 或 Cmd+F）
3. 找到這一行：
   ```
   STIMULUS_DURATION_MS: 2000, // ← 教師可改：圖片顯示秒數（2秒）
   ```
4. 把 `2000` 改成 `3000`（變成 3 秒）：
   ```
   STIMULUS_DURATION_MS: 3000, // ← 教師可改：圖片顯示秒數（3秒）
   ```
5. 存檔、測試

### 修改範例：降低通關門檻

**需求**：83% 太難了，想改成 70%。

**步驟**：

1. 搜尋 `PASS_THRESHOLD`
2. 把 `0.83` 改成 `0.7`：
   ```
   PASS_THRESHOLD: 0.7,  // ← 教師可改：通關門檻（70%）
   ```

### 修改範例：調整出題比例（增加難度）

**需求**：想讓「不要按」的題目更常出現（增加難度）。

**步驟**：

1. 搜尋 `MOUSE_GO`
2. 把 `0.75` 改成 `0.6`（要按的比例從 75% 降到 60%）
3. **同時**把 `MOUSE_NOGO` 的 `0.25` 改成 `0.4`
4. ⚠️ **重要：兩個數字加起來必須 = 1.0**

[🔝 回到目錄](#目錄) · [📄 需求文件](完整需求文件v4.5.md#top) · [🛠️ 開發規範](開發規範與工具.md#top)

---

<a id="檔案2場地對照表"></a>

## 📁 4. 檔案 2：場地對照表

**檔案位置**：`js/shared/combo-selector.js`

這個檔案定義了場地 A/B/C/D 分別對應哪種遊戲。

### 修改範例：改場地名稱

**需求**：想把「場地A：起司森林」改成「場地A：快樂草原」。

**步驟**：

1. 打開 `js/shared/combo-selector.js`
2. 搜尋 `場地A：起司森林`
3. 把引號內的文字改成想要的：
   ```
   name: "場地A：快樂草原",  // ← 教師可改：場地顯示名稱
   ```

### 修改範例：改場地圖示

**需求**：想把場地A的圖示從 🧀 改成 🌲。

**步驟**：

1. 搜尋場地A的 `icon:`
2. 把 Emoji 替換掉：
   ```
   icon: "🌲",  // ← 教師可改：場地圖示 Emoji
   ```
3. 💡 **怎麼輸入 Emoji？**
   - Mac：按 `Ctrl + Cmd + 空白鍵` 打開 Emoji 選擇器
   - Windows：按 `Win + .`（句號鍵）打開 Emoji 選擇器

[🔝 回到目錄](#目錄) · [📄 需求文件](完整需求文件v4.5.md#top) · [🛠️ 開發規範](開發規範與工具.md#top)

---

<a id="檔案3顏色與字體"></a>

## 📁 5. 檔案 3：顏色與字體

**檔案位置**：`css/themes/base.css`

整個遊戲的顏色、字體大小、間距都在這裡。修改這裡，所有頁面都會跟著變。

### 修改範例：換主色調

**需求**：想把主色調從藍色換成橘色。

**步驟**：

1. 打開 `css/themes/base.css`
2. 搜尋 `--primary-blue`
3. 把 `#3498db` 改成 `#e67e22`：
   ```
   --primary-blue: #e67e22;  /* ← 教師可改：主色調（橘色） */
   ```

### 修改範例：放大字體

**需求**：覺得按鈕文字太小。

**步驟**：

1. 搜尋 `--font-size-lg`
2. 把 `1.5rem` 改成 `1.8rem`：
   ```
   --font-size-lg: 1.8rem;  /* ← 教師可改：大字（29px） */
   ```

### 修改範例：放大遊戲按鈕

**需求**：幼兒按不到按鈕，想放大。

**步驟**：

1. 搜尋 `--touch-target-min`
2. 把 `56px` 改成 `72px`：
   ```
   --touch-target-min: 72px;  /* ← 教師可改：按鈕最小尺寸 */
   ```

[🔝 回到目錄](#目錄) · [📄 需求文件](完整需求文件v4.5.md#top) · [🛠️ 開發規範](開發規範與工具.md#top)

---

<a id="檔案4首頁文字"></a>

## 📁 6. 檔案 4：首頁文字

**檔案位置**：`home.html`

> ⚠️ 注意：首頁是 `home.html`（不是 `index.html`）。`index.html` 是進站前的登入頁面。

玩家進入遊戲後看到的主選單畫面，有 6 張模式卡片。

### 修改範例：改遊戲名稱

**步驟**：

1. 打開 `home.html`
2. 搜尋 `執行功能訓練遊戲`
3. 把 `<h1>` 和 `</h1>` 之間的文字改掉：
   ```html
   <h1>🎮 我的超棒遊戲</h1>
   ```

> ⚠️ 注意：`<h1>` 和 `</h1>` 是 HTML 標籤，只改中間的文字就好。

[🔝 回到目錄](#目錄) · [📄 需求文件](完整需求文件v4.5.md#top) · [🛠️ 開發規範](開發規範與工具.md#top)

---

<a id="檔案5故事對話文字"></a>

## 📁 7. 檔案 5：故事對話文字

**檔案位置**：`content/stories/` 資料夾（12 個 `.txt` 檔案）

遊戲中 12 個探險點（6 個小老鼠 + 6 個釣魚）的劇情對話全部放在這裡。  
每個檔案都是純中文文字，**不需要懂任何程式碼就能修改**！

### 檔案清單

| 檔案                      | 探險點                              | 角色                  |
| ------------------------- | ----------------------------------- | --------------------- |
| `01-mouse-r1.txt`         | 🐭 小老鼠 規則一                    | 🦉 阿智               |
| `02-mouse-r1-wm.txt`      | 🐭 規則一 + 工作記憶                | 🦉 阿智               |
| `03-mouse-r2.txt`         | 🐭 規則二（反轉）                   | 🦊 淘淘 + 🦉 阿智     |
| `04-mouse-r2-wm.txt`      | 🐭 規則二 + 工作記憶                | 🦉 阿智               |
| `05-mouse-mixed.txt`      | 🐭 混合規則                         | 🦊 淘淘 + 🦉 阿智     |
| `06-mouse-mixed-wm.txt`   | 🐭 混合 + 工作記憶（地圖 1 最終關） | 🦉 阿智               |
| `07-fishing-r1.txt`       | 🐟 釣魚 規則一                      | 🦉 阿智               |
| `08-fishing-r1-wm.txt`    | 🐟 規則一 + 工作記憶                | 🦉 阿智               |
| `09-fishing-r2.txt`       | 🐟 規則二（反轉）                   | 🦊 淘淘 + 🦉 阿智     |
| `10-fishing-r2-wm.txt`    | 🐟 規則二 + 工作記憶                | 🦉 阿智               |
| `11-fishing-mixed.txt`    | 🐟 混合規則                         | 🦊 淘淘 + 🦉 阿智     |
| `12-fishing-mixed-wm.txt` | 🐟 混合 + 工作記憶（最終關卡！）    | 🦅 金鷹王者 + 🦉 阿智 |

### txt 格式說明

每個檔案有 **3 段**，用 `---` 分隔：

```
[開場] mentor
遊戲開始前的對話文字...

---

[通過] mentor
孩子通過後的鼓勵文字...

---

[失敗] mentor
沒通過時的安慰文字...
```

- `[開場]` `[通過]` `[失敗]`：段落標記，**不要改**
- `mentor` / `villain` / `legendaryEagle`：說話角色的英文代號，**不要改**
- 第二行以後的中文文字：**這才是要改的內容！**

### 角色代號對照

| 英文代號         | 中文名   | 圖示 |
| ---------------- | -------- | ---- |
| `mentor`         | 阿智     | 🦉   |
| `villain`        | 淘淘     | 🦊   |
| `legendaryEagle` | 金鷹王者 | 🦅   |

### 修改範例：改第一關的開場白

**需求**：覺得開場白太長，想精簡。

**步驟**：

1. 打開 `content/stories/01-mouse-r1.txt`
2. 找到 `[開場] mentor` 下方的文字
3. 改成想要的內容，例如：
   ```
   [開場] mentor
   嗨！看到🧀起司就按，看到😺貓咪不要動！
   ```
4. 存檔
5. **⚠️ 重要**：請開發者執行以下指令讓修改生效：
   ```
   node tools/build-stories.js
   ```

### ⚠️ 注意事項

- ✅ 可以改：中文對話文字、Emoji
- ❌ 不要改：`[開場]` `[通過]` `[失敗]` 標記
- ❌ 不要改：角色英文代號（`mentor` / `villain` / `legendaryEagle`）
- ❌ 不要刪除 `---` 分隔線
- 💡 改完後一定要請開發者執行 `node tools/build-stories.js`

> 📖 更完整的說明請參考 `content/stories/README.md`

[🔝 回到目錄](#目錄) · [📄 需求文件](完整需求文件v4.5.md#top) · [🛠️ 開發規範](開發規範與工具.md#top)

---

<a id="量表評估功能"></a>

## 📋 8. 量表評估功能（TC-CHEXI）

**頁面位置**：`assessment/index.html`（從首頁的「📋 量表評估」卡片進入）

此功能提供 **TC-CHEXI 執行功能量表**，讓教師或家長在遊戲訓練前後各填寫一次，自動產生前後測比較報告。

### 功能說明

| 項目 | 說明 |
| ---- | ---- |
| 量表內容 | 24 題，涵蓋工作記憶、計畫組織、規範行為、抑制控制 4 個分量表 |
| 評分方式 | 5 點量尺（完全不正確～完全正確），分數越**高** = 困難越**大** |
| 前後測判斷 | 系統根據同一位孩子的「兒童代碼」自動判斷是前測或後測 |
| 比較報告 | 後測填寫完成後自動顯示：長條圖對比、箭頭變化、表情符號等級、白話文解讀 |
| 匯出 | 可匯出 PDF 比較報告、CSV 全部紀錄、JSON 備份 |
| 隱私 | 所有資料儲存在填寫者的裝置本機（localStorage），**不上傳伺服器** |

### 什麼是「兒童代碼」？

- **由研究者事先分配**給每位受測兒童的文字代號（例如 `P001`、`P002`）
- 長度最多 20 字元，指用者手動輸入，不分大小寫
- **用途**：系統根據這個代碼，將同一位兒童的前測和後測配對在一起
- **重要**：同一位兒童的前測和後測必須使用**完全相同的代碼**，否則系統無法配對

### 前後測如何判定？

| 情況 | 系統行為 |
| ---- | -------- |
| 該代碼無任何紀錄 | 自動判定為**前測** |
| 該代碼已有前測、無後測 | 自動判定為**後測**，完成後自動出比較報告 |
| 該代碼已有前測和後測 | 再次填寫會**覆蓋舊的後測**，並顯示警告提示 |

> 💡 系統會在輸入代碼時即時顯示「前測 / 後測」指示器，不需要自己記。

### 教師可操作的事項

1. **訓練前**：請家長/教師填寫前測量表（輸入兒童代碼 → 填寫 24 題 → 查看結果）
2. **訓練後**：再次填寫量表（輸入**相同的兒童代碼** → 系統自動偵測為後測）
3. **查看報告**：後測完成後自動顯示前後測比較報告，可匯出 PDF
4. **查看歷史**：頁面下方的「歷史紀錄」區可查看過去所有填寫紀錄
5. **刪除紀錄**：每筆紀錄旁有 `✕` 按鈕可刪除單筆；底部有「清除全部」按鈕
6. **備份紀錄**：點擊「💾 備份紀錄 (JSON)」可匯出備份檔，換裝置時再「📂 匯入備份」還原
7. **匯出 CSV**：點擊「📥 匯出全部 CSV」可匯出所有紀錄，用 Excel 開啟

### 資料儲存與管理

| 項目 | 說明 |
| ---- | ---- |
| 儲存位置 | 瀏覽器 localStorage（key：`efgame-chexi-records`） |
| 資料安全 | **不上傳伺服器**，僅存在填寫者的裝置上 |
| 備份方式 | 頁面上的「💾 備份紀錄 (JSON)」按鈕 |
| 還原方式 | 頁面上的「📂 匯入備份」按鈕（會自動去重複） |
| 刪除單筆 | 歷史紀錄列表中每筆旁的 `✕` 按鈕 |
| 刪除全部 | 底部的「🗑️ 清除全部紀錄」按鈕（不可復原） |
| ⚠️ 消失風險 | 清除瀏覽器資料、換裝置、無痕模式都會導致資料消失，**請定期備份** |

> ⚠️ 量表題目內容在 `js/assessment/tc-chexi-items.json`，通常**不需要修改**。

[🔝 回到目錄](#目錄) · [📄 需求文件](完整需求文件v4.5.md#top) · [🛠️ 開發規範](開發規範與工具.md#top)

---

<a id="修改步驟教學"></a>

## 🛠️ 9. 修改步驟教學

### 第一次修改？跟著這個步驟走

1. **打開 VS Code**（程式碼編輯器）
2. **打開專案資料夾**（File → Open Folder）
3. **找到要修改的檔案**（在左邊的檔案清單中點開）
4. **搜尋關鍵字**（Cmd+F 或 Ctrl+F）
5. **只修改數字或中文文字**
6. **存檔**（Cmd+S 或 Ctrl+S）
7. **測試**（在瀏覽器中重新整理頁面）

### 單位對照表

| 程式碼中的單位 | 換算               |
| -------------- | ------------------ |
| 1000（毫秒）   | = 1 秒             |
| 0.75           | = 75%              |
| 1rem           | = 16px（像素）     |
| #3498db        | = 一種藍色（色碼） |

### 常用數值對照

| 毫秒  | 等於幾秒 |
| ----- | -------- |
| 500   | 0.5 秒   |
| 1000  | 1 秒     |
| 1500  | 1.5 秒   |
| 2000  | 2 秒     |
| 3000  | 3 秒     |
| 5000  | 5 秒     |
| 10000 | 10 秒    |

| 小數 | 等於百分比 |
| ---- | ---------- |
| 0.5  | 50%        |
| 0.6  | 60%        |
| 0.7  | 70%        |
| 0.75 | 75%        |
| 0.8  | 80%        |
| 0.83 | 83%        |
| 0.9  | 90%        |
| 1.0  | 100%       |

[🔝 回到目錄](#目錄) · [📄 需求文件](完整需求文件v4.5.md#top) · [🛠️ 開發規範](開發規範與工具.md#top)

---

<a id="常見問題-faq"></a>

## ❓ 10. 常見問題 FAQ

### Q1：改壞了怎麼辦？

**方法一**：按 `Cmd+Z`（Mac）或 `Ctrl+Z`（Windows）復原修改。

**方法二**：如果已經存檔，可以用 Git 回復：

```
右鍵點擊檔案 → Source Control → Discard Changes
```

### Q2：怎麼知道我改的設定有沒有生效？

在瀏覽器中：

1. 重新整理頁面（Cmd+R 或 F5）
2. 如果沒有變化，按 `Cmd+Shift+R`（強制重新整理，清除快取）

### Q3：改了數值但遊戲壞了？

常見原因：

- ❌ 不小心刪了逗號 `,` 或冒號 `:`
- ❌ GO + NOGO 比例加起來不等於 1.0
- ❌ MIN 比 MAX 大

解決方式：回到上一步的修改，確認符號和數值都正確。

### Q4：場地有幾個？可以新增嗎？

目前共有 **12 個場地**（A–L），分為「小老鼠」6 關和「釣魚」6 關。如需新增更多場地，請聯絡開發者協助。

### Q5：其他頁面的文字怎麼改？

所有 HTML 頁面的修改方式都一樣：

1. 找到對應的 `.html` 檔案
2. 搜尋想改的中文文字
3. 修改 `< >` 標籤之間的文字
4. 不要動 `< >` 標籤本身

[🔝 回到目錄](#目錄) · [📄 需求文件](完整需求文件v4.5.md#top) · [🛠️ 開發規範](開發規範與工具.md#top)

---

<a id="研究者進階"></a>

## 🔬 11. 研究者進階

> 本章節適合需要調整實驗參數、理解自適應演算法、或匯出資料進行統計分析的研究者。

### 11.1 自適應難度引擎

遊戲內建三種難度引擎，可透過 `js/game-config.js` 中的 `ADAPTIVE_ENGINE` 切換：

| 引擎 | 設定值 | 說明 |
| ---- | ------ | ---- |
| 簡易自適應 | `"simple"` | 連對 2 題升級、連錯 2 題降級（**預設**） |
| IRT 智慧版 | `"irt"` | 3PL 模型 + EAP 估計，根據能力值 θ 選題 |
| 固定難度 | `"static"` | 鎖定 Level 3，不自適應 |

**優先順序**：URL 參數 `?engine=xxx` > localStorage > `game-config.js` 設定

#### Simple Adaptive — 5 級時間參數

| Level | 刺激呈現 | ISI 最小 | ISI 最大 | 回饋時間 |
| ----- | -------- | -------- | -------- | -------- |
| 1（最易） | 3000 ms | 1000 ms | 1500 ms | 1200 ms |
| 2 | 2500 ms | 900 ms | 1300 ms | 1000 ms |
| 3（預設） | 2000 ms | 800 ms | 1200 ms | 800 ms |
| 4 | 1500 ms | 600 ms | 1000 ms | 600 ms |
| 5（最難） | 1200 ms | 500 ms | 800 ms | 500 ms |

#### Simple Adaptive — 5 級工作記憶參數

| Level | 最少位置 | 最多位置 | 亮起時間 |
| ----- | -------- | -------- | -------- |
| 1 | 2 | 3 | 1000 ms |
| 2 | 2 | 4 | 900 ms |
| 3 | 2 | 6 | 800 ms |
| 4 | 3 | 6 | 700 ms |
| 5 | 3 | 6 | 600 ms |

#### IRT 引擎 — 3PL 模型參數

$$P(\theta) = c + \frac{1-c}{1 + e^{-a(\theta - b)}}$$

| Level | $a$（鑑別度） | $b$（難度） | $c$（猜測） |
| ----- | ------------- | ----------- | ----------- |
| 1 | 1.0 | −2.0 | 0.5 |
| 2 | 1.2 | −1.0 | 0.5 |
| 3 | 1.5 | 0.0 | 0.5 |
| 4 | 1.3 | +1.0 | 0.5 |
| 5 | 1.0 | +2.0 | 0.5 |

- $c = 0.5$：Go/NoGo 為二擇一，隨機猜測率 50%
- $\theta$ 離散估計點：`[-3, -2.5, …, +2.5, +3]`，先驗 $N(0,1)$
- 暖身期：前 3 題鎖定 Level 3，之後依 $\theta$ 選題
- 平滑約束：每次最多升降 1 級
- 持久化：`localStorage` key `ef_irt_state`，7 天有效

### 11.2 Go/NoGo 出題比例

| 場景 | Go 比例 | NoGo 比例 |
| ---- | ------- | --------- |
| 🐭 小老鼠（rule1/rule2） | 75% | 25% |
| 🐟 釣魚（rule1/rule2） | 80% | 20% |
| 混合規則 — 情境 A | 80% | 20% |
| 練習模式 | 50% | 50% |

修改位置：`js/game-config.js` → `RATIOS` 區塊（約 L122–L130）

### 11.3 場地規則與訓練目標對應

| 規則 | 小老鼠 | 釣魚 | 訓練目標 |
| ---- | ------ | ---- | -------- |
| rule1 | Go=🧀起司 / NoGo=😺貓 | Go=🐟魚 / NoGo=🦈鯊 | 抑制控制 |
| rule2 | Go=😺貓 / NoGo=🧀起司 | Go=🦈鯊 / NoGo=🐟魚 | 認知彈性 |
| mixed | 有人在場→rule2 / 無人→rule1 | 白天→rule1 / 夜晚→rule2 | 工作記憶＋認知彈性 |

### 11.4 逐題紀錄欄位

每一筆 trial 記錄的完整欄位（可用於事後統計分析）：

| 欄位 | 說明 |
| ---- | ---- |
| `trialNumber` | 第幾題 |
| `stimulusKey` | 刺激物代碼 |
| `contextKey` | 情境代碼（mixed 規則才有意義） |
| `isGo` | 是否為 Go 試題 |
| `correctAction` | 正確反應（tap / withhold） |
| `playerAction` | 玩家實際反應 |
| `result` | hit / miss / correctRejection / falseAlarm |
| `isCorrect` | 答對與否 |
| `rt` | 反應時間（ms） |
| `timestamp` | 毫秒級時間戳 |
| `fieldId` / `ruleId` | 場地與規則 |
| `adaptiveEngine` | 使用的引擎名稱 |
| `difficultyLevel` | 該題難度等級（1–5） |
| `theta` | IRT θ 估計值（僅 IRT 模式） |

IRT 模式額外欄位（透過 `getIRTHistory()`）：`fromLevel`, `toLevel`, `thetaSE`, `itemB`, `itemA`, `fisherInfo`

### 11.5 資料匯出方式

| 方法 | 操作 | 匯出內容 |
| ---- | ---- | -------- |
| 瀏覽器 Console | 開啟 DevTools → 執行 `exportGameData()` | JSON：玩家 profile、探險進度、班級資料 |
| 教師管理後台 | 管理頁面 → 匯出按鈕 | JSON：`efgame-teacher-YYYY-MM-DD.json`（所有學生成績） |
| TC-CHEXI 報告 | 量表評估頁 → 匯出 PDF | PDF 前後測比較報告 |

> 💡 **提示**：如需更詳細的 CSV 格式匯出或批次分析腳本，請聯絡開發者協助。

### 11.6 Firebase 資料結構

**Firestore 集合：**

| 路徑 | 說明 | 關鍵欄位 |
| ---- | ---- | -------- |
| `classLeaderboards/{boardId}` | 班級排行看板 | boardName, code, entryCount |
| `classLeaderboards/{boardId}/entries/{uid}` | 學生成績 | score, accuracy, avgRT, stars, **dPrime, criterion, beta**（SDT 指標） |
| `worldLeaderboard/{uid_fieldId_ruleId}` | 世界排行榜 | bestScore, bestAccuracy, bestAvgRT, gamesPlayed, totalStars |

**Realtime Database（多人模式）：**

| 路徑 | 說明 |
| ---- | ---- |
| `rooms/{roomCode}` | 房間資料 |
| `rooms/{roomCode}/players/{uid}` | 玩家資料 |
| `rooms/{roomCode}/scores` | 遊戲分數 |

**localStorage Keys（本機儲存）：**

| Key | 說明 |
| --- | ---- |
| `efgame-player-profile` | 玩家 profile（座號、暱稱、星星、等級、徽章） |
| `efgame-adventure-progress` | 探險進度（12 點各自的 passed, bestScore, starsEarned, bestTime） |
| `ef_adaptive_level` | Simple 引擎難度等級 |
| `ef_irt_state` | IRT 引擎狀態（level, theta, thetaSE） |
| `ef_engine_choice` | 引擎選擇偏好 |

### 11.7 實用 URL 參數

| 參數 | 範例 | 說明 |
| ---- | ---- | ---- |
| `?engine=irt` | 切換為 IRT 引擎 | 覆蓋 game-config.js 設定 |
| `?engine=static` | 固定難度模式 | 鎖定 Level 3 不動 |
| `?unlock=all` | 解鎖所有場地 | 跳過漸進解鎖限制（測試用） |

### 11.8 學術引用

如在論文中引用本遊戲的自適應演算法，可參考：

- Embretson, S. E., & Reise, S. P. (2000). *Item response theory for psychologists*. Lawrence Erlbaum.
- van der Linden, W. J., & Glas, C. A. W. (2010). *Elements of adaptive testing*. Springer.
- 蔡青霖、Thorell, L. B.、Siu, A. F. Y.、許育軒、林慧麗（2020）。繁體中文兒童執行功能量表：編修、心理計量特質檢驗與常模建立。*測驗學刊*，67(2)，119-143。

[🔝 回到目錄](#目錄) · [📄 需求文件](完整需求文件v4.5.md#top) · [🛠️ 開發規範](開發規範與工具.md#top)

---

## 📋 檔案索引

| 檔案路徑                       | 教師可改內容                     | 優先級    |
| ------------------------------ | -------------------------------- | --------- |
| `js/game-config.js`            | 時間、題數、分數、難度、場地規則 | 🔴 最高   |
| `js/shared/combo-selector.js`  | 場地名稱、代號、圖示             | 🔴 最高   |
| `content/stories/*.txt`        | 12 個探險點的劇情對話文字        | 🔴 最高   |
| `css/themes/base.css`          | 顏色、字體大小、間距、觸控尺寸   | 🟡 中等   |
| `css/main.css`                 | 通常不需要改（改 base.css 即可） | ⚪ 不需要 |
| `js/svg-assets.js`             | 遊戲圖案（建議聯絡開發者）       | ⚪ 不需要 |
| `assessment/index.html`        | 量表評估頁面                     | 🟡 中等   |
| `js/assessment/tc-chexi-items.json` | 量表題目（通常不需改）      | ⚪ 不需要 |
| `home.html`                    | 首頁主選單文字                   | 🟢 一般   |
| `index.html`                   | 進站登入頁文字                   | 🟢 一般   |
| `multiplayer/room-create.html` | 建立房間頁面文字                 | 🟢 一般   |
| 其他 `*.html`                  | 各頁面文字內容                   | 🟢 一般   |

[🔝 回到目錄](#目錄) · [📄 需求文件](完整需求文件v4.5.md#top) · [🛠️ 開發規範](開發規範與工具.md#top)

---

> 💬 有任何問題，請聯絡開發者（小摩研究助理）。
