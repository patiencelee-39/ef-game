<!DOCTYPE html>

<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />

    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>åŸ·è¡ŒåŠŸèƒ½èªçŸ¥è¨“ç·´ - RWDéŸ¿æ‡‰å¼ç‰ˆ</title>

    <meta
      name="description"
      content="ä¸­åŸå¤§å­¸ç‰¹æ®Šæ•™è‚²å­¸ç³»é–‹ç™¼çš„åŸ·è¡ŒåŠŸèƒ½èªçŸ¥è¨“ç·´å·¥å…·ã€‚"
    />
    <meta name="author" content="ä¸­åŸå¤§å­¸ç‰¹æ®Šæ•™è‚²å­¸ç³»ç ”ç©¶åœ˜éšŠ" />
    <meta
      name="keywords"
      content="åŸ·è¡ŒåŠŸèƒ½, èªçŸ¥è¨“ç·´, è½éšœæ•™è‚², ä¸­åŸå¤§å­¸, Go-NoGo"
    />

    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:;"
    />

    <style>
      /* === [è‰¯å¥½å¯¦è¸] CSS è®Šæ•¸ (Variables) ===
         :root ä»£è¡¨ç¶²é çš„æ ¹ç›®éŒ„ã€‚æˆ‘å€‘æŠŠæ‰€æœ‰é¡è‰²éƒ½å–åå­—ä¸¦å®šç¾©åœ¨é€™è£¡ï¼Œå°±åƒæ˜¯èª¿è‰²ç›¤ã€‚
         â˜… [æ•™å­¸ï¼šå¦‚ä½•ä¿®æ”¹é¡è‰²]
         å¦‚æœä½ æƒ³æŠŠèƒŒæ™¯æ”¹æˆé»‘è‰²ï¼Œåªè¦æŠŠ --bg-color å¾Œé¢çš„ #2c3e50 æ”¹æˆ #000000 å³å¯ã€‚
         å¥½è™•æ˜¯æ”¹ä¸€å€‹åœ°æ–¹ï¼Œæ•´å€‹ç¶²ç«™éƒ½æœƒä¸€èµ·è®Šï¼Œä¸ç”¨ä¸€è¡Œä¸€è¡Œæ‰¾ã€‚
      */
      :root {
        --bg-color: #2c3e50; /* èƒŒæ™¯è‰²ï¼šæ·±è—ç° */
        --text-color: #ecf0f1; /* æ–‡å­—è‰²ï¼šç±³ç™½ */
        --primary-color: #3498db; /* ä¸»è¦æŒ‰éˆ•è—è‰² */
        --success-color: #2ecc71; /* ç­”å°æ™‚çš„ç¶ è‰² */
        --error-color: #e74c3c; /* ç­”éŒ¯æ™‚çš„ç´…è‰² */
        --accent-yellow: #f1c40f; /* æ˜Ÿæ˜Ÿçš„é»ƒè‰² */
        --round1-color: #e67e22; /* ç¬¬ä¸€å›ä»£è¡¨è‰² (æ©˜è‰²) */
        --round2-color: #9b59b6; /* ç¬¬äºŒå›ä»£è¡¨è‰² (ç´«è‰²) */
        --practice-color: #1abc9c; /* ç·´ç¿’æ¨¡å¼ä»£è¡¨è‰² (é’è‰²) */
      }

      /* body æ˜¯ç¶²é çš„ã€Œèº«é«”ã€ï¼Œè¨­å®šå…¨åŸŸçš„åŸºç¤æ¨£å¼ */
      body {
        font-family: "å¾®è»Ÿæ­£é»‘é«”", sans-serif; /* è¨­å®šå­—é«”ï¼Œæ²’æœ‰å¾®è»Ÿæ­£é»‘é«”å°±ç”¨ç³»çµ±é è¨­ */
        background-color: var(--bg-color); /* ä½¿ç”¨ä¸Šé¢å®šç¾©çš„è®Šæ•¸ */
        color: var(--text-color);
        text-align: center; /* è®“æ‰€æœ‰æ–‡å­—ç½®ä¸­ */
        margin: 0; /* å»é™¤ç€è¦½å™¨é è¨­çš„é‚Šé‚Šç©ºç™½ */
        padding: 10px; /* [èª¿æ•´] ç¶²é å…§éƒ¨ç•™ç™½ç¸®å°ï¼ŒæŠŠç©ºé–“ç•™çµ¦å…§å®¹ */

        /* Flexbox æ’ç‰ˆï¼šé€™æ˜¯ä¸€ç¨®å¾ˆå¼·å¤§çš„æ’ç‰ˆæ¨¡å¼ï¼Œå¯ä»¥è®“æ±è¥¿ä¹–ä¹–æ’å¥½ */
        display: flex;
        flex-direction: column; /* å…§å®¹ç”±ä¸Šå¾€ä¸‹å‚ç›´æ’åˆ— */
        align-items: center; /* å…§å®¹å·¦å³ç½®ä¸­å°é½Š */
        min-height: 100vh; /* æœ€å°é«˜åº¦è¨­ç‚ºè¦–çª—é«˜åº¦çš„ 100% (vh = viewport height) */

        /* å„ªåŒ–è§¸æ§è¢å¹•çš„é»æ“Šåæ‡‰ï¼Œé¿å…å»¶é² */
        touch-action: manipulation;

        /* box-sizing: border-box; 
           é€™å€‹è¨­å®šå¾ˆé‡è¦ï¼å®ƒè®“ padding (å…§è·) åŒ…å«åœ¨å¯¬åº¦è¨ˆç®—å…§ã€‚
           å¦‚æœæ²’æœ‰é€™è¡Œï¼Œè¨­å®š width: 100% å†åŠ  paddingï¼Œç¶²é å°±æœƒçˆ†ç‰ˆå‡ºç¾æ²è»¸ã€‚
        */
        box-sizing: border-box;
      }

      /* === ä¸»è¦éŠæˆ²å€åŸŸ (ä¿®æ­£ç‰ˆ) === */
      .game-area {
        background-color: #34495e;
        border-radius: 15px; /* è®“æ¡†æ¡†è®Šåœ“è§’ */
        padding: 20px;
        width: 100%; /* å¯¬åº¦ä½”æ»¿çˆ¶å®¹å™¨ */
        max-width: 600px; /* ä½†æœ€å¤§ä¸è¶…é 600px (é¿å…åœ¨é›»è…¦è¢å¹•ä¸Šå¤ªå¯¬) */
        margin: 10px auto; /* ä¸Šä¸‹è·é›¢ 10pxï¼Œå·¦å³è‡ªå‹• (auto) ç½®ä¸­ */

        /* [RWD ä¿®æ­£é‡é»] 
           é€™è£¡ä¸ç”¨å›ºå®š height (ä¾‹å¦‚ 600px)ï¼Œè€Œæ˜¯ç”¨ min-height (æœ€å°é«˜åº¦)ã€‚
           é€™æ¨£å…§å®¹å°‘æ™‚ä¿æŒ 500px é«˜ï¼Œå…§å®¹å¤šæ™‚ç›’å­æœƒè‡ªå‹•é•·é«˜ï¼Œæ–‡å­—å°±ä¸æœƒè¢«åˆ‡æ‰ã€‚
        */
        min-height: 500px;
        height: auto;

        border: 5px solid transparent; /* é ç•™ 5px çš„é€æ˜é‚Šæ¡†ï¼Œçµ¦å›é¥‹å‹•ç•«(é–ƒç´…/é–ƒç¶ )ç”¨ */
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3); /* é™°å½±æ•ˆæœï¼šè®“æ¡†æ¡†çœ‹èµ·ä¾†æµ®èµ·ä¾† */

        display: flex;
        flex-direction: column; /* å…§å®¹å‚ç›´æ’åˆ— */
        justify-content: space-between; /* å…§å®¹åˆ†æ•£å°é½Š (é ­é ‚å¤©ã€è…³è¸©åœ°ï¼Œä¸­é–“ç•™ç™½) */
        align-items: center;
        position: relative; /* ç›¸å°å®šä½ï¼šè®“è£¡é¢çš„çµ•å°å®šä½å…ƒç´ ä»¥å®ƒç‚ºåŸºæº– */
        box-sizing: border-box; /* ç¢ºä¿ padding ç®—åœ¨å¯¬åº¦å…§ */
      }

      /* åˆºæ¿€ç‰© (æ˜Ÿæ˜Ÿ/å¤ªé™½) çš„å®¹å™¨ */
      .stimulus {
        font-size: 150px; /* â˜… [æ•™å­¸] æƒ³è¦åœ–æ¡ˆå¤§ä¸€é»ï¼ŸæŠŠé€™å€‹æ•¸å­—æ”¹å¤§ï¼ */
        height: 200px;
        width: 200px;
        display: flex;
        justify-content: center; /* æ°´å¹³ç½®ä¸­ */
        align-items: center; /* å‚ç›´ç½®ä¸­ */
        transition: transform 0.1s; /* å‹•ç•«éæ¸¡æ™‚é–“ 0.1 ç§’ */
        margin: 20px auto; /* ä¸Šä¸‹ç•™é»ç©ºé–“ */
      }
      /* ç•¶åœ–æ¡ˆåŠ ä¸Š pop é€™å€‹ class æ™‚ï¼Œæœƒæ”¾å¤§ 1.3 å€ */
      .stimulus.pop {
        transform: scale(1.3);
      }

      /* æŒ‰éˆ•å€å®¹å™¨ */
      .controls-area {
        width: 100%;
        display: flex;
        justify-content: space-around; /* è®“å…©å€‹æŒ‰éˆ•å¹³å‡åˆ†æ•£ */
        padding-bottom: 10px;
        gap: 15px; /* æŒ‰éˆ•ä¹‹é–“çš„é–“è· */
      }

      /* æŒ‰éµæ¨£å¼ */
      .btn-key {
        flex: 1; /* è®“å…©å€‹æŒ‰éˆ•å¹³åˆ†å¯¬åº¦ */
        height: 120px; /* é›»è…¦ç‰ˆé«˜åº¦ */
        border: none; /* å»æ‰é‚Šæ¡† */
        border-radius: 15px;
        font-size: 3em; /* é›»è…¦ç‰ˆå­—é«”å¤§å° */
        color: white;
        cursor: pointer; /* æ»‘é¼ ç§»ä¸Šå»è®Šæ‰‹æŒ‡ */
        display: flex;
        flex-direction: column; /* è£¡é¢çš„åœ–æ¡ˆå’Œæ–‡å­—å‚ç›´æ’åˆ— */
        justify-content: center;
        align-items: center;
        transition: transform 0.1s, opacity 0.3s; /* å‹•ç•«è¨­å®š */
        box-shadow: 0 4px 0 rgba(0, 0, 0, 0.2); /* æŒ‰éˆ•ä¸‹æ–¹çš„ç«‹é«”é™°å½± */
        -webkit-tap-highlight-color: transparent; /* æ‰‹æ©Ÿé»æ“Šæ™‚ä¸è¦å‡ºç¾é è¨­è—è‰²æ¡†æ¡† */
      }

      /* ç•¶æŒ‰éˆ•è¢«æŒ‰ä¸‹ (active) æ™‚çš„ç‰¹æ•ˆ */
      .btn-key:active,
      .btn-key.active-key {
        transform: translateY(4px); /* æŒ‰éˆ•å¾€ä¸‹ç§» 4pxï¼Œçœ‹èµ·ä¾†åƒè¢«å£“ä¸‹å» */
        box-shadow: none; /* é™°å½±æ¶ˆå¤±ï¼Œé…åˆå¾€ä¸‹ç§»çš„æ•ˆæœ */
      }

      .btn-f {
        background-color: #f1c40f; /* é»ƒè‰² */
        color: #2c3e50;
      }
      .btn-j {
        background-color: #e67e22; /* æ©˜è‰² */
      }
      /* ç¦ç”¨æŒ‰éˆ•çš„æ¨£å¼ (ä¾‹å¦‚ç¬¬äºŒå›ä¸èƒ½æŒ‰çš„æ™‚å€™) */
      .btn-disabled {
        background-color: #7f8c8d; /* ç°è‰² */
        opacity: 0.3; /* è®ŠåŠé€æ˜ */
        pointer-events: none; /* è®“å®ƒç„¡æ³•è¢«é»æ“Š */
      }

      /* æŒ‰éµä¸Šçš„æç¤ºæ–‡å­— (ä¾‹å¦‚ï¼šKeyboard F) */
      .key-hint {
        font-size: 1rem; /* ä½¿ç”¨ rem (ç›¸å°å–®ä½) æ¯”è¼ƒå¥½æ§åˆ¶ */
        opacity: 0.8; /* ç¨å¾®é€æ˜ */
        margin-bottom: 5px;
        font-weight: bold;
      }

      /* === [RWD æ‰‹æ©Ÿç‰ˆå„ªåŒ–æ ¸å¿ƒ] === 
         @media æŸ¥è©¢ï¼šé€™æ˜¯éŸ¿æ‡‰å¼è¨­è¨ˆçš„éˆé­‚ã€‚
         æ„æ€ï¼šç•¶è¢å¹•å¯¬åº¦å°æ–¼ 600px æ™‚ (é€šå¸¸æ˜¯æ‰‹æ©Ÿç›´æ‹¿)ï¼ŒåŸ·è¡Œå¤§æ‹¬è™Ÿå…§çš„ CSS è¨­å®šã€‚
         é€™è®“æˆ‘å€‘å¯ä»¥åœ¨åŒä¸€ä»½æª”æ¡ˆè£¡ï¼ŒåŒæ™‚ç…§é¡§é›»è…¦å’Œæ‰‹æ©Ÿç‰ˆé¢ã€‚
      */
      @media (max-width: 600px) {
        body {
          padding: 5px; /* æ‰‹æ©Ÿç•«é¢å°ï¼Œé‚Šè·ç¸®å°ä¸€é» */
        }

        .game-area {
          min-height: 80vh; /* æ‰‹æ©Ÿç‰ˆé«˜åº¦ä½”è¢å¹• 80% */
          padding: 15px;
        }

        /* ç¸®å°åœ–æ¡ˆï¼Œé¿å…æ‰‹æ©Ÿä¸Šçœ‹èµ·ä¾†å¤ªå¤§ */
        .stimulus {
          font-size: 100px; /* â˜… [æ•™å­¸] æ‰‹æ©Ÿç‰ˆåœ–æ¡ˆå¤§å°åœ¨é€™è£¡æ”¹ */
          height: 120px;
          width: 120px;
          margin: 10px auto;
        }

        /* ç¸®å°æŒ‰éˆ• */
        .btn-key {
          height: 100px; /* æ‰‹æ©Ÿç‰ˆæŒ‰éˆ•çŸ®ä¸€é» */
          font-size: 2.5em; /* æ‰‹æ©Ÿç‰ˆç¬¦è™Ÿå°ä¸€é» */
        }

        .key-hint {
          font-size: 0.8rem;
        }

        /* èª¿æ•´èªªæ˜æ–‡å­—å¤§å° */
        .landing-info {
          padding: 15px;
        }
        .landing-info h3 {
          font-size: 1.2em;
        }
        .landing-info p {
          font-size: 0.9em;
        }

        /* èª¿æ•´è¦å‰‡åœ–ç¤º */
        .rule-icon {
          font-size: 2.5em;
        }
        .rule-key {
          font-size: 2em;
          padding: 5px 10px;
        }

        /* [èª¿æ•´] æ‰‹æ©Ÿç‰ˆæŒ‰éˆ•å­—é«”å¾®èª¿ */
        .btn {
          font-size: 1.1em; /* ç¨å¾®å°ä¸€é»é»ç¢ºä¿ä¸æœƒçˆ†ç‰ˆ */
        }
      }

      /* --- ä»¥ä¸‹ä¿æŒåŸæœ‰æ¨£å¼ (é€šç”¨è¨­å®š) --- */

      /* é¦–é èªªæ˜å€å¡Š */
      .landing-info {
        background: rgba(255, 255, 255, 0.1); /* åŠé€æ˜èƒŒæ™¯ */
        padding: 30px;
        border-radius: 15px;
        max-width: 600px;
        margin-bottom: 20px;
        text-align: left; /* æ–‡å­—é å·¦ */
        border-left: 5px solid var(--primary-color); /* å·¦é‚ŠåŠ ä¸€æ¢è—è‰²è£é£¾ç·š */
      }
      .landing-info h3 {
        margin-top: 0;
        color: var(--primary-color);
      }
      .landing-info p {
        line-height: 1.6; /* è¡Œé«˜ï¼Œè®“æ–‡å­—å¥½è®€ */
        opacity: 0.9;
      }

      /* è¦å‰‡èªªæ˜å®¹å™¨ (ä¸¦æ’é¡¯ç¤º) */
      .tutorial-container {
        display: flex;
        flex-direction: row;
        justify-content: center;
        gap: 10px;
        margin-bottom: 20px;
        width: 100%;
      }
      /* è¦å‰‡å°æ¡†æ¡† */
      .rule-box {
        background: rgba(255, 255, 255, 0.1);
        padding: 15px;
        border-radius: 15px;
        display: flex;
        flex-direction: column;
        align-items: center;
        flex: 1; /* å·¦å³å…©å€‹æ¡†æ¡†ç­‰å¯¬ */
        border: 2px solid rgba(255, 255, 255, 0.1);
      }
      .rule-box.left-box {
        background: rgba(230, 126, 34, 0.2);
      }
      .rule-box.right-box {
        background: rgba(241, 196, 15, 0.2);
      }
      .rule-icon {
        font-size: 3em;
        margin-bottom: 5px;
      }
      .rule-arrow {
        font-size: 1.5em;
        color: #bdc3c7;
        margin: 5px 0;
      }
      /* æ¨¡æ“¬éµç›¤æŒ‰éµåœ–ç¤º */
      .rule-key {
        border: 2px solid #fff;
        border-radius: 10px;
        padding: 5px 15px;
        font-family: monospace; /* ç­‰å¯¬å­—é«”ï¼Œçœ‹èµ·ä¾†åƒç¨‹å¼ç¢¼ */
        background: rgba(0, 0, 0, 0.3);
        font-size: 2.5em;
        font-weight: bold;
        display: inline-block;
        margin-bottom: 5px;
      }
      .key-desc {
        font-size: 1em;
        opacity: 0.9;
      }

      /* å›åˆæ¨™ç±¤ (å¦‚ï¼šç¬¬ä¸€å›) */
      .round-label {
        position: absolute; /* çµ•å°å®šä½ï¼šå¯ä»¥ç–Šåœ¨çˆ¶å…ƒç´ ä¸Šæ–¹ */
        top: 10px;
        left: 50%;
        transform: translateX(-50%); /* æ°´å¹³ç½®ä¸­ä¿®æ­£ */
        padding: 5px 15px;
        border-radius: 20px;
        font-size: 0.9em;
        font-weight: bold;
        z-index: 10; /* ç¢ºä¿æµ®åœ¨æœ€ä¸Šå±¤ */
        white-space: nowrap; /* ç¢ºä¿æ–‡å­—ä¸æ›è¡Œ */
      }
      .round-practice {
        background-color: var(--practice-color);
      }
      .round1-badge {
        background-color: var(--round1-color);
      }
      .round2-badge {
        background-color: var(--round2-color);
      }

      /* é€²åº¦æ¢èƒŒæ™¯ */
      .progress-container {
        width: 100%;
        height: 8px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 10px;
        overflow: hidden; /* ç¢ºä¿è£¡é¢çš„æ¢ä¸æœƒè·‘å‡ºåœ“è§’å¤– */
        margin-top: 10px;
      }
      /* é€²åº¦æ¢æœ¬é«” */
      .progress-bar {
        height: 100%;
        background: linear-gradient(90deg, #3498db, #2ecc71); /* é¡è‰²æ¼¸å±¤ */
        border-radius: 10px;
        transition: width 0.3s ease; /* å¯¬åº¦æ”¹è®Šæ™‚è¦æœ‰æ»‘å‹•å‹•ç•« */
        width: 0%; /* ä¸€é–‹å§‹æ˜¯ 0% */
      }

      /* å›é¥‹å‹•ç•« Class (JS æœƒå‹•æ…‹åŠ å…¥é€™äº› class) */
      .feedback-success {
        animation: pulse-green 0.3s ease-out; /* åŸ·è¡Œ pulse-green å‹•ç•« */
        border-color: var(--success-color) !important;
      }
      .feedback-error {
        animation: shake-red 0.2s ease-in-out; /* åŸ·è¡Œ shake-red å‹•ç•« */
        border-color: var(--error-color) !important;
      }

      /* @keyframes å®šç¾©å‹•ç•«çš„é—œéµå½±æ ¼ (Keyframes) */
      /* ç¶ è‰²è„ˆè¡å‹•ç•« (ç­”å°) */
      @keyframes pulse-green {
        0% {
          transform: scale(1);
          box-shadow: 0 0 0 0 rgba(46, 204, 113, 0.7);
        }
        50% {
          transform: scale(1.02);
          box-shadow: 0 0 0 15px rgba(46, 204, 113, 0);
        }
        100% {
          transform: scale(1);
          box-shadow: 0 0 0 0 rgba(46, 204, 113, 0);
        }
      }
      /* ç´…è‰²éœ‡å‹•å‹•ç•« (ç­”éŒ¯) - å·¦å³æ™ƒå‹• */
      @keyframes shake-red {
        0%,
        100% {
          transform: translateX(0);
        }
        25% {
          transform: translateX(-15px); /* å¾€å·¦ç§» */
        }
        75% {
          transform: translateX(15px); /* å¾€å³ç§» */
        }
      }

      /* åœ–æ¡ˆçš„æ­£ç¢º/éŒ¯èª¤å‹•ç•« */
      @keyframes pulse-correct {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.3);
          filter: brightness(1.5);
        }
        100% {
          transform: scale(1);
        }
      }
      @keyframes shake-error {
        0%,
        100% {
          transform: translateX(0) rotate(0deg);
        }
        25% {
          transform: translateX(-10px) rotate(-5deg);
        }
        75% {
          transform: translateX(10px) rotate(5deg);
        }
      }

      .correct-flash {
        animation: pulse-correct 0.5s ease-out;
        filter: drop-shadow(0 0 20px #2ecc71);
      }
      .error-flash {
        animation: shake-error 0.4s ease-in-out;
        filter: drop-shadow(0 0 20px #e74c3c);
      }

      /* [è‰¯å¥½å¯¦è¸] ç”¨ class ä¾†æ§åˆ¶é¡¯ç¤º/éš±è—ï¼Œæ¯”ç›´æ¥æ”¹ style.display æ›´å¥½ç®¡ç† */
      .hidden {
        display: none !important;
      }
      /* ç•«é¢å±¤ï¼Œç”¨ä¾†åˆ‡æ›ä¸åŒçš„éŠæˆ²éšæ®µ (æ­¡è¿é ã€éŠæˆ²ä¸­ã€çµæœé ) */
      .screen-layer {
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }

      /* === é€šç”¨æŒ‰éˆ• (ä¿®æ”¹ç‰ˆ) === 
         é€™è£¡æˆ‘å€‘ä½¿ç”¨äº†ç™¾åˆ†æ¯”å¯¬åº¦ï¼Œè®“æŒ‰éˆ•åœ¨ä¸åŒè¢å¹•ä¸Šéƒ½èƒ½é©æ‡‰ã€‚
      */
      .btn {
        background-color: var(--primary-color);
        color: white;
        border: none;

        /* [ä¿®æ”¹] å¯¬åº¦è¨­å®š */
        width: 90%; /* ä½”æ»¿çˆ¶å®¹å™¨çš„ 90%ï¼Œç¢ºä¿åœ¨æ‰‹æ©Ÿä¸Šå¤ å¯¬ */
        max-width: 400px; /* è¨­å®šæœ€å¤§å¯¬åº¦ï¼Œé¿å…åœ¨é›»è…¦è¢å¹•ä¸Šè®Šå¤ªé•· */

        /* [ä¿®æ”¹] å…§è·èˆ‡æ–‡å­— */
        padding: 12px 0; /* ä¸Šä¸‹ç•™ç™½ï¼Œå·¦å³å› ç‚ºå¤ å¯¬æ‰€ä»¥è¨­ç‚º 0 æˆ–è‡ªå‹• */
        font-size: 1.2em;
        white-space: nowrap; /* â˜… é—œéµï¼šå¼·åˆ¶æ–‡å­—ä¸æ›è¡Œï¼Œè§£æ±ºæŒ‰éˆ•æ–‡å­—æŠ˜è¡Œå•é¡Œ */

        border-radius: 50px; /* åœ“è§’ */
        cursor: pointer;
        margin-top: 15px;
        box-sizing: border-box; /* ç¢ºä¿å¯¬åº¦åŒ…å«æ¡†ç·šå’Œå…§è· */
      }

      /* æ–‡å­—é–ƒçˆå‹•ç•« */
      .blink-text {
        animation: blink 1.5s infinite;
      }
      @keyframes blink {
        0% {
          opacity: 1;
        }
        50% {
          opacity: 0.6;
        }
        100% {
          opacity: 1;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <h1>ğŸ§  åŸ·è¡ŒåŠŸèƒ½èªçŸ¥è¨“ç·´</h1>
      <p style="opacity: 0.7; font-size: 0.8em">
        ä¸­åŸå¤§å­¸ç‰¹æ•™ç³» | ç ”ç©¶å·¥å…· v2.9 (Wide Button)
      </p>
    </header>

    <main class="game-area" id="gameContainer">
      <div id="landingPage" class="screen-layer">
        <div class="landing-info">
          <h3>ğŸ« é—œæ–¼æœ¬ç ”ç©¶å·¥å…·</h3>
          <p>
            æœ¬å·¥å…·ç”±
            <a
              href="https://special.cycu.edu.tw/"
              target="_blank"
              style="color: var(--primary-color); text-decoration: underline"
            >
              ä¸­åŸå¤§å­¸ç‰¹æ®Šæ•™è‚²å­¸ç³»
            </a>
            é–‹ç™¼ï¼Œæ—¨åœ¨å”åŠ©è½éšœå­¸ç«¥é€²è¡Œã€ŒåŸ·è¡ŒåŠŸèƒ½ã€çš„è¨“ç·´èˆ‡è©•ä¼°ã€‚
          </p>
          <hr
            style="
              border: 0;
              border-top: 1px solid rgba(255, 255, 255, 0.2);
              margin: 15px 0;
            "
          />

          <p><strong>ğŸ”’ éš±ç§æ¬Šè²æ˜ï¼š</strong></p>
          <p>
            æœ¬æ¸¬é©—ç‚ºç´”å‰ç«¯é‹ä½œï¼Œæ‚¨çš„åæ‡‰æ™‚é–“èˆ‡æ­£ç¢ºç‡æ•¸æ“š<b>åƒ…æš«å­˜æ–¼ç€è¦½å™¨ä¸­</b>ï¼Œæˆ‘å€‘ä¸æœƒå°‡ä»»ä½•å€‹äººè³‡æ–™ä¸Šå‚³è‡³ä¼ºæœå™¨ã€‚
          </p>
          <p style="margin-top: 15px; font-size: 0.9em; opacity: 0.8">
            ğŸ“§ å°ˆæ¡ˆè¯çµ¡äººï¼šç ”ç©¶åœ˜éšŠ (
            <a
              href="https://github.com/patiencelee-39/ef-training-game"
              target="_blank"
              style="color: var(--accent-yellow)"
              >GitHub</a
            >
            )
          </p>
        </div>
        <button class="btn" onclick="game.showTutorial()">
          ğŸ‘‰ é€²å…¥æ¸¬é©—èªªæ˜
        </button>
        <br />
        <small
          ><a href="privacy.html" style="color: #bdc3c7"
            >è©³ç´°éš±ç§æ¬Šæ”¿ç­–</a
          ></small
        >
        <div style="margin-top: 30px; font-size: 0.7em; opacity: 0.5">
          &copy; 2026 CYCU. All Rights Reserved.
        </div>
      </div>

      <div id="introScreen" class="screen-layer hidden">
        <h2>ç·´ç¿’æ¨¡å¼</h2>

        <p style="margin-bottom: 20px; color: #bdc3c7; font-size: 0.9em">
          çœ‹ â­ æŒ‰å·¦é‚ŠFéµã€€ã€€ã€€ã€€ã€€ã€€ã€€çœ‹ â˜€ï¸ æŒ‰å³é‚ŠJéµ
        </p>
        <div class="tutorial-container">
          <div class="rule-box left-box">
            <span class="rule-icon">â­</span>
            <span class="rule-arrow">â¬‡</span>
            <span class="rule-key">F</span>
            <span class="key-desc">å·¦æ‰‹</span>
          </div>
          <div class="rule-box right-box">
            <span class="rule-icon">â˜€ï¸</span>
            <span class="rule-arrow">â¬‡</span>
            <span class="rule-key">J</span>
            <span class="key-desc">å³æ‰‹</span>
          </div>
        </div>
        <button class="btn blink-text" onclick="game.startPractice()">
          âŒ¨ï¸ æŒ‰ç©ºç™½éµ(æˆ–é»æ­¤)é–‹å§‹
        </button>
        <h4>ç·´ç¿’æ¨¡å¼ä¸è¨ˆåˆ†</h4>
      </div>

      <div id="practiceEndScreen" class="screen-layer hidden">
        <h2>ğŸ‘ ç·´ç¿’å®Œæˆï¼</h2>
        <p>åšå¾—å¾ˆæ£’ï¼çŸ¥é“æ€éº¼ç©äº†å—ï¼Ÿ</p>
        <p>æ¥ä¸‹ä¾†è¦<b>æ­£å¼é–‹å§‹</b>å›‰ï¼</p>
        <div style="margin-top: 20px; width: 100%; text-align: center">
          <button class="btn blink-text" onclick="game.startRound1()">
            âŒ¨ï¸ æŒ‰ç©ºç™½éµ(æˆ–é»æ­¤)é–‹å§‹
          </button>
          <h4>å¾ç¾åœ¨é–‹å§‹æœƒè¨ˆåˆ†å–”</h4>
        </div>
      </div>

      <div id="intermissionScreen" class="screen-layer hidden">
        <h2 style="color: var(--round2-color)">âš ï¸ è¦å‰‡æ”¹è®Šäº†ï¼</h2>
        <div class="tutorial-container">
          <div
            class="rule-box left-box"
            style="background: rgba(127, 140, 141, 0.5)"
          >
            <span class="rule-icon">â­</span>
            <span class="rule-arrow">â¬‡</span>
            <span class="rule-icon" style="font-size: 2.5em">âŒ</span>
            <span
              class="key-desc"
              style="color: var(--error-color); font-weight: bold"
              >ä¸è¦æŒ‰ï¼</span
            >
          </div>
          <div class="rule-box right-box">
            <span class="rule-icon">â˜€ï¸</span>
            <span class="rule-arrow">â¬‡</span>
            <span class="rule-key">J</span>
            <span class="key-desc">è¦æŒ‰ï¼</span>
          </div>
        </div>
        <button class="btn blink-text" onclick="game.startRound2()">
          âŒ¨ï¸ æŒ‰ç©ºç™½éµ(æˆ–é»æ­¤)é–‹å§‹
        </button>
        <h4>æœƒè¨ˆåˆ†å–”</h4>
      </div>

      <div
        id="playScreen"
        class="hidden"
        style="
          width: 100%;
          height: 100%;
          display: flex;
          flex-direction: column;
          justify-content: space-between;
        "
      >
        <div style="width: 100%">
          <div id="roundLabel" class="round-label round1-badge">ç¬¬ä¸€å›</div>
          <div
            style="
              margin-top: 25px;
              display: flex;
              justify-content: space-between;
              padding: 0 10px;
            "
          >
            <span
              >é€²åº¦: <span id="currentTrialDisplay">0</span>/<span
                id="totalTrialDisplay"
                >10</span
              ></span
            >
          </div>
          <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
          </div>
        </div>

        <div id="stimulusBox" class="stimulus"></div>

        <div class="controls-area">
          <button
            id="btnF"
            class="btn-key btn-f"
            onpointerdown="game.handleInput('F')"
          >
            <span class="key-hint">æŒ‰éµ F</span>â­
          </button>
          <button
            id="btnJ"
            class="btn-key btn-j"
            onpointerdown="game.handleInput('J')"
          >
            <span class="key-hint">æŒ‰éµ J</span>â˜€ï¸
          </button>
        </div>
      </div>

      <div id="resultScreen" class="screen-layer hidden">
        <h2>ğŸ‰ å…¨éƒ¨å®Œæˆï¼</h2>
        <div
          style="
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 10px;
            width: 100%;
            box-sizing: border-box;
          "
        >
          <p>
            ç­”å°é¡Œæ•¸ï¼š<span
              id="scoreDisplay"
              style="color: var(--success-color); font-size: 1.5em"
              >0</span
            >
          </p>
          <p>å¹³å‡é€Ÿåº¦ï¼š<span id="avgTimeDisplay">0ms</span></p>
        </div>
        <button class="btn" onclick="location.reload()">ğŸ”„ å›åˆ°é¦–é </button>
        <button
          class="btn"
          onclick="game.exportData()"
          style="background-color: #7f8c8d"
        >
          ğŸ“¥ åŒ¯å‡ºè³‡æ–™
        </button>
      </div>
    </main>

    <script>
      /* === [è‰¯å¥½å¯¦è¸] è¨­å®šæª” (Configuration Object) ===
         åŸå‰‡ï¼šé¿å…åœ¨ç¨‹å¼ç¢¼ä¸­æ•£è½ã€Œé­”æ³•æ•¸å­—ã€(Magic Numbers)ã€‚
         æˆ‘å€‘æŠŠæ‰€æœ‰éœ€è¦èª¿æ•´çš„åƒæ•¸éƒ½æ”¾åœ¨é€™è£¡ï¼Œæ–¹ä¾¿ç®¡ç†ã€‚
         åƒè€ƒä¾†æºï¼šã€Šç¨‹å¼ç¢¼è‰¯å¥½å¯¦è¸å®Œæ•´æŒ‡å—ã€‹ç¬¬ 1.3 ç¯€ å¸¸æ•¸å‘½å
         â˜… [æ•™å­¸ï¼šå¦‚ä½•èª¿æ•´é›£åº¦]
         å¦‚æœä½ è¦ºå¾—éŠæˆ²å¤ªå¿«ï¼ŒæŠŠ stimulusDuration (åœ–æ¡ˆå‡ºç¾æ™‚é–“) æ”¹å¤§ä¸€é»ã€‚
         isiMin/Max æ˜¯å…©é¡Œä¹‹é–“çš„ä¼‘æ¯æ™‚é–“ï¼Œæ”¹å¤§å°±æœƒè®Šæ…¢ã€‚
      */
      const CONFIG = {
        practiceTrials: 3, // ç·´ç¿’é¡Œæ•¸ (æƒ³ç·´ä¹…ä¸€é»æ”¹å¤§é€™å€‹æ•¸å­—)
        round1Trials: 3, // ç¬¬ä¸€å›é¡Œæ•¸
        round2Trials: 3, // ç¬¬äºŒå›é¡Œæ•¸
        stimulusDuration: 1500, // åœ–æ¡ˆå‡ºç¾å¹¾æ¯«ç§’å¾Œæ¶ˆå¤± (1500ms = 1.5ç§’)
        isiMin: 800, // å…©é¡Œä¹‹é–“æœ€å¿«ä¼‘æ¯å¹¾æ¯«ç§’
        isiMax: 1200, // å…©é¡Œä¹‹é–“æœ€æ…¢ä¼‘æ¯å¹¾æ¯«ç§’
        goRatio: 0.5, // å‡ºç¾ç›®æ¨™(Go)çš„æ©Ÿç‡ (0.5 = 50%)
      };

      /*
         === [è‰¯å¥½å¯¦è¸] éŠæˆ²ç‰©ä»¶ (Game Object) ===
         åŸå‰‡ï¼šå–®ä¸€è·è²¬èˆ‡å°è£ (Encapsulation)ã€‚
         åƒè€ƒä¾†æºï¼šã€Šç¨‹å¼ç¢¼è‰¯å¥½å¯¦è¸å®Œæ•´æŒ‡å—ã€‹ç¬¬ 2.1 ç¯€
         æˆ‘å€‘æŠŠæ‰€æœ‰è·ŸéŠæˆ²æœ‰é—œçš„è®Šæ•¸ (score, timer...) å’Œå‡½æ•¸ (nextTrial, showStimulus...)
         éƒ½æ‰“åŒ…åœ¨ `game` é€™å€‹ç‰©ä»¶è£¡ã€‚
         é€™æ¨£æ‰ä¸æœƒè®“è®Šæ•¸åç¨±è·Ÿå…¶ä»–äººæ‰“æ¶ï¼Œç¨‹å¼ç¢¼çµæ§‹ä¹Ÿæ¯”è¼ƒæ¸…æ¥šã€‚
      */
      const game = {
        // State (ç‹€æ…‹)ï¼šè¨˜éŒ„éŠæˆ²ç¾åœ¨é€²è¡Œåˆ°å“ªè£¡ï¼Œåƒæ˜¯ã€ŒéŠæˆ²é€²åº¦å­˜æª”ã€
        state: {
          currentRound: 1, // ç›®å‰ç¬¬å¹¾å›
          currentTrial: 0, // ç›®å‰ç¬¬å¹¾é¡Œ
          totalTrials: 0, // é€™å›åˆç¸½å…±å¹¾é¡Œ
          score: 0, // å¾—åˆ†
          results: [], // å„²å­˜æ¯ä¸€é¡Œçš„æ•¸æ“š (é™£åˆ—)
          isPlaying: false, // éŠæˆ²æ˜¯å¦æ­£åœ¨é€²è¡Œ
          isPractice: false, // æ˜¯å¦ç‚ºç·´ç¿’æ¨¡å¼
          currentStimulus: null, // ç¾åœ¨å‡ºç¾çš„æ˜¯æ˜Ÿæ˜Ÿé‚„æ˜¯å¤ªé™½
          startTime: 0, // é¡Œç›®å‡ºç¾çš„æ™‚é–“é» (ç”¨ä¾†ç®—åæ‡‰æ™‚é–“)
          responded: false, // ä½¿ç”¨è€…æ˜¯å¦å·²ç¶“æŒ‰éµ
          timer: null, // è¨ˆæ™‚å™¨ ID
        },

        // Elements (å…ƒç´ )ï¼šé å…ˆæŠ“å– HTML å…ƒç´ å­˜èµ·ä¾†ï¼Œæå‡æ•ˆèƒ½
        // é€™æ¨£å°±ä¸ç”¨æ¯æ¬¡è¦æ”¹ç•«é¢æ™‚éƒ½å» document.getElementById æ‰¾ä¸€æ¬¡
        elements: {
          container: document.getElementById("gameContainer"), // æ•´å€‹éŠæˆ²æ¡†
          screens: {
            // å„å€‹ç•«é¢çš„å®¹å™¨
            landing: document.getElementById("landingPage"),
            intro: document.getElementById("introScreen"),
            practiceEnd: document.getElementById("practiceEndScreen"),
            intermission: document.getElementById("intermissionScreen"),
            play: document.getElementById("playScreen"),
            result: document.getElementById("resultScreen"),
          },
          stimulus: document.getElementById("stimulusBox"),
          btnF: document.getElementById("btnF"),
          btnJ: document.getElementById("btnJ"),
          roundLabel: document.getElementById("roundLabel"),
          trialDisplay: document.getElementById("currentTrialDisplay"),
          totalDisplay: document.getElementById("totalTrialDisplay"),
          scoreDisplay: document.getElementById("scoreDisplay"),
          avgTimeDisplay: document.getElementById("avgTimeDisplay"),
        },

        // é¡¯ç¤ºæ•™å­¸ç•«é¢
        showTutorial: function () {
          this.showScreen("intro");
        },

        // é–‹å§‹ç·´ç¿’æ¨¡å¼
        startPractice: function () {
          this.state.isPractice = true;
          this.state.currentRound = 1;
          this.state.totalTrials = CONFIG.practiceTrials;
          // è¨­å®š UI æ–‡å­—
          this.elements.roundLabel.innerText = "ç·´ç¿’æ¨¡å¼";
          this.elements.roundLabel.className = "round-label round-practice";
          // å•Ÿç”¨ F éµ (ç§»é™¤ç¦ç”¨çš„æ¨£å¼)
          this.elements.btnF.classList.remove("btn-disabled");
          this.elements.btnF.innerHTML =
            '<span class="key-hint">æŒ‰éµ F</span>â­';
          this.initGameSession();
        },

        // é–‹å§‹ç¬¬ä¸€å› (æ­£å¼)
        startRound1: function () {
          this.state.isPractice = false;
          this.state.currentRound = 1;
          this.state.totalTrials = CONFIG.round1Trials;
          this.state.results = []; // æ¸…ç©ºä¹‹å‰çš„ç´€éŒ„
          this.elements.roundLabel.innerText = "ç¬¬ä¸€å›ï¼šè¾¨è­˜";
          this.elements.roundLabel.className = "round-label round1-badge";
          this.elements.btnF.classList.remove("btn-disabled");
          this.elements.btnF.innerHTML =
            '<span class="key-hint">æŒ‰éµ F</span>â­';
          this.initGameSession();
        },

        // é–‹å§‹ç¬¬äºŒå› (æŠ‘åˆ¶)
        startRound2: function () {
          this.state.isPractice = false;
          this.state.currentRound = 2;
          this.state.totalTrials = CONFIG.round2Trials;
          this.elements.roundLabel.innerText = "ç¬¬äºŒå›ï¼šæŠ‘åˆ¶";
          this.elements.roundLabel.className = "round-label round2-badge";
          // åœç”¨ F éµ (classList.add æ–°å¢ CSS class)
          this.elements.btnF.classList.add("btn-disabled");
          // [ä¿®æ”¹é€™è£¡] æ§åˆ¶æŒ‰éˆ•æ–‡å­—å¤§å°
          // åŸæœ¬ï¼š '<span class="key-hint">â­</span>å¿ä½'
          // ä¿®æ”¹å¾Œï¼šåŠ ä¸Š style="font-size: 0.6em;" è®“ã€Œå¿ä½ã€è®Šå°
          this.elements.btnF.innerHTML =
            '<span class="key-hint" style="font-size: 3rem;">â­</span><span style="font-size: 0.6em;">å¿ä½</span>';
          this.initGameSession();
        },

        // åˆå§‹åŒ–ä¸€å›åˆçš„éŠæˆ²
        initGameSession: function () {
          this.state.currentTrial = 0;
          this.state.score = 0;
          this.state.isPlaying = true;
          this.elements.totalDisplay.innerText = this.state.totalTrials;
          this.showScreen("play");
          this.nextTrial(); // é–‹å§‹ç¬¬ä¸€é¡Œ
        },

        // é€²å…¥ä¸‹ä¸€é¡Œ
        nextTrial: function () {
          // æª¢æŸ¥æ˜¯å¦æ‰€æœ‰é¡Œç›®éƒ½åšå®Œäº†
          if (this.state.currentTrial >= this.state.totalTrials) {
            this.endSession(); // çµæŸé€™å›åˆ
            return;
          }
          this.state.currentTrial++;
          this.updateUI(); // æ›´æ–°é€²åº¦æ¢
          // æ¸…ç©ºç•«é¢ç‹€æ…‹
          this.elements.stimulus.innerText = "";
          this.elements.container.className = "game-area"; // ç§»é™¤æˆåŠŸ/å¤±æ•—çš„å›é¥‹è‰²
          this.elements.stimulus.classList.remove("pop");
          this.state.responded = false;

          // è¨ˆç®—éš¨æ©Ÿç­‰å¾…æ™‚é–“ (Math.random ç”¢ç”Ÿéš¨æ©Ÿæ•¸)
          // é€™æ¨£ç©å®¶å°±ç„¡æ³•é æ¸¬åœ–æ¡ˆä»€éº¼æ™‚å€™å‡ºç¾
          const delay =
            Math.floor(Math.random() * (CONFIG.isiMax - CONFIG.isiMin + 1)) +
            CONFIG.isiMin;
          // setTimeout: è¨­å®šä¸€å€‹è¨ˆæ™‚å™¨ï¼Œæ™‚é–“åˆ°ä¹‹å¾ŒåŸ·è¡Œ showStimulus
          setTimeout(() => this.showStimulus(), delay);
        },

        // é¡¯ç¤ºåˆºæ¿€ç‰© (æ˜Ÿæ˜Ÿæˆ–å¤ªé™½)
        showStimulus: function () {
          // éš¨æ©Ÿæ±ºå®šæ˜¯å¤ªé™½é‚„æ˜¯æ˜Ÿæ˜Ÿ
          const isStar = Math.random() < CONFIG.goRatio;
          this.state.currentStimulus = isStar ? "sun" : "star";
          // è¨­å®šåœ–æ¡ˆèˆ‡é¡è‰²
          if (isStar) {
            this.elements.stimulus.innerText = "â˜€ï¸";
            this.elements.stimulus.style.color = "#f39c12";
          } else {
            this.elements.stimulus.innerText = "â­";
            this.elements.stimulus.style.color = "#f1c40f";
          }
          // è¨˜éŒ„ç¾åœ¨æ™‚é–“ (Date.now())ï¼Œç”¨ä¾†è¨ˆç®—åæ‡‰é€Ÿåº¦
          this.state.startTime = Date.now();
          // è¨­å®šé€¾æ™‚è¨ˆæ™‚å™¨ï¼šå¦‚æœç©å®¶éƒ½ä¸æŒ‰ï¼Œæ™‚é–“åˆ°äº†å°±åŸ·è¡Œ handleTimeout
          this.state.timer = setTimeout(() => {
            if (!this.state.responded) {
              this.handleTimeout();
            }
          }, CONFIG.stimulusDuration);
        },

        // è™•ç†ä½¿ç”¨è€…è¼¸å…¥ (æŒ‰ä¸‹ F æˆ– J)
        handleInput: function (keyInput) {
          // é˜²å‘†æ©Ÿåˆ¶ï¼šå¦‚æœæ²’åœ¨ç©ã€æˆ–å·²ç¶“æŒ‰éäº†ã€æˆ–åœ–æ¡ˆé‚„æ²’å‡ºä¾†ï¼Œå°±ä¸ç†æœƒ
          if (
            !this.state.isPlaying ||
            this.state.responded ||
            !this.elements.stimulus.innerText
          )
            return;
          this.state.responded = true;
          clearTimeout(this.state.timer); // æ¸…é™¤é€¾æ™‚è¨ˆæ™‚å™¨

          // æŒ‰éˆ•çš„è¦–è¦ºå›é¥‹ (åŠ å…¥ .active-key è®“æŒ‰éˆ•å¾€ä¸‹å£“)
          const btn =
            keyInput === "J" ? this.elements.btnJ : this.elements.btnF;
          btn.classList.add("active-key");
          // 100ms å¾Œç§»é™¤ active-keyï¼Œè®“æŒ‰éˆ•å½ˆå›ä¾†
          setTimeout(() => btn.classList.remove("active-key"), 100);

          // è¨ˆç®—åæ‡‰æ™‚é–“ (ç¾åœ¨æ™‚é–“ - é¡Œç›®å‡ºç¾æ™‚é–“)
          const reactionTime = Date.now() - this.state.startTime;
          const stimulus = this.state.currentStimulus;
          let isCorrect = false;

          // åˆ¤æ–·å°éŒ¯é‚è¼¯
          if (this.state.currentRound === 1) {
            // ç¬¬ä¸€å›ï¼šæ˜Ÿæ˜ŸæŒ‰ Fï¼Œå¤ªé™½æŒ‰ J
            if (stimulus === "star" && keyInput === "F") isCorrect = true;
            else if (stimulus === "sun" && keyInput === "J") isCorrect = true;
          } else {
            // ç¬¬äºŒå›ï¼šå¤ªé™½æŒ‰ Jï¼Œæ˜Ÿæ˜Ÿä¸èƒ½æŒ‰ (é€™æ˜¯æŠ‘åˆ¶ä»»å‹™)
            if (stimulus === "sun" && keyInput === "J") isCorrect = true;
            else isCorrect = false; // æ˜Ÿæ˜ŸæŒ‰äº†å°±ç®—éŒ¯
          }

          this.triggerFeedback(isCorrect); // é¡¯ç¤ºå›é¥‹(é–ƒç¶ /é–ƒç´…)
          this.recordResult(isCorrect, reactionTime, keyInput); // å­˜æª”
          setTimeout(() => this.nextTrial(), 800); // å»¶é²ä¸€ä¸‹å†é€²ä¸‹ä¸€é¡Œ
        },

        // è™•ç†é€¾æ™‚ (ä½¿ç”¨è€…åœ¨æ™‚é–“å…§æ²’æœ‰æŒ‰éµ)
        handleTimeout: function () {
          this.state.responded = true;
          const stimulus = this.state.currentStimulus;
          let isCorrect = false;
          if (this.state.currentRound === 1) {
            isCorrect = false; // ç¬¬ä¸€å›ä¸€å®šè¦æŒ‰ï¼Œæ²’æŒ‰å°±éŒ¯
          } else {
            // ç¬¬äºŒå›ï¼šæ˜Ÿæ˜Ÿä¸èƒ½æŒ‰ï¼Œæ‰€ä»¥å¦‚æœé€™é¡Œæ˜¯æ˜Ÿæ˜Ÿä¸”æ²’æŒ‰ï¼Œå°±å°äº†ï¼
            if (stimulus === "star") isCorrect = true;
            else isCorrect = false;
          }
          if (isCorrect) this.triggerFeedback(true);
          else this.triggerFeedback(false);
          this.recordResult(isCorrect, 0, "none");
          setTimeout(() => this.nextTrial(), 800);
        },

        // è§¸ç™¼è¦–è¦ºå›é¥‹ (ç•«é¢é–ƒç¶ è‰²æˆ–ç´…è‰²)
        triggerFeedback: function (isSuccess) {
          // å…ˆç§»é™¤ä¹‹å‰çš„ class
          this.elements.container.classList.remove(
            "feedback-success",
            "feedback-error"
          );
          this.elements.stimulus.classList.remove(
            "correct-flash",
            "error-flash"
          );
          // é­”æ³•æŠ€å·§ï¼šå¼·åˆ¶ç€è¦½å™¨é‡ç¹ª (Reflow)ï¼Œè®“ CSS Animation å¯ä»¥é‡æ–°æ’­æ”¾
          void this.elements.container.offsetWidth;

          if (isSuccess) {
            this.elements.container.classList.add("feedback-success");
            this.elements.stimulus.classList.add("correct-flash");
          } else {
            this.elements.container.classList.add("feedback-error");
            this.elements.stimulus.classList.add("error-flash");
          }
        },

        // è¨˜éŒ„è©²é¡Œçµæœ
        recordResult: function (isCorrect, rt, inputKey) {
          if (isCorrect) {
            this.state.score++;
            // åˆ†æ•¸å‹•ç•«
            const scoreEl = document.getElementById("scoreDisplay");
            if (scoreEl) {
              scoreEl.style.transform = "scale(1.3)";
              scoreEl.style.color = "#2ecc71";
              setTimeout(() => {
                scoreEl.style.transform = "scale(1)";
              }, 300);
            }
          }
          // åªæœ‰æ­£å¼æ¸¬é©—æ‰è¨˜éŒ„æ•¸æ“šï¼Œç·´ç¿’æ¨¡å¼ä¸è¨˜
          if (!this.state.isPractice) {
            // .push() æŠŠè³‡æ–™åŠ åˆ°é™£åˆ—çš„æœ€å¾Œé¢
            this.state.results.push({
              round: this.state.currentRound,
              trial: this.state.currentTrial,
              stimulus: this.state.currentStimulus,
              input: inputKey,
              correct: isCorrect ? "yes" : "no",
              rt: rt,
            });
          }
        },

        // çµæŸé€™ä¸€å›åˆ
        endSession: function () {
          this.state.isPlaying = false;
          if (this.state.isPractice) {
            this.showScreen("practiceEnd");
          } else if (this.state.currentRound === 1) {
            this.showScreen("intermission");
          } else {
            this.showFinalResult();
          }
        },

        // é¡¯ç¤ºæœ€çµ‚æˆç¸¾
        showFinalResult: function () {
          this.showScreen("result");
          // è¨ˆç®—æ­£ç¢ºé¡Œæ•¸ (filter ç¯©é¸å‡ºæ­£ç¢ºçš„é¡Œç›®ï¼Œlength å–å¾—æ•¸é‡)
          const totalCorrect = this.state.results.filter(
            (r) => r.correct === "yes"
          ).length;
          // è¨ˆç®—å¹³å‡åæ‡‰æ™‚é–“
          const validTrials = this.state.results.filter(
            (r) => r.input === "J" && r.correct === "yes"
          );
          const avgRT =
            validTrials.length > 0
              ? Math.round(
                  validTrials.reduce((sum, r) => sum + r.rt, 0) /
                    validTrials.length
                )
              : 0;
          this.elements.scoreDisplay.innerText = totalCorrect;
          this.elements.avgTimeDisplay.innerText = avgRT + "ms";
        },

        // æ›´æ–°ä»‹é¢ (é€²åº¦æ¢)
        updateUI: function () {
          this.elements.trialDisplay.innerText = this.state.currentTrial;
          const progressBar = document.getElementById("progressBar");
          if (progressBar) {
            // è¨ˆç®—é€²åº¦ç™¾åˆ†æ¯”
            const progress =
              ((this.state.currentTrial - 1) / this.state.totalTrials) * 100;
            progressBar.style.width = progress + "%";
            // é€²åº¦æ¢é¡è‰²éš¨é€²åº¦è®ŠåŒ– (è— -> é»ƒ -> ç¶ )
            if (progress < 30) progressBar.style.background = "#3498db";
            else if (progress < 70) progressBar.style.background = "#f39c12";
            else progressBar.style.background = "#2ecc71";
          }
        },

        // åˆ‡æ›é¡¯ç¤ºçš„ç•«é¢ (Helper function)
        showScreen: function (name) {
          // å…ˆæŠŠæ‰€æœ‰ç•«é¢éƒ½åŠ ä¸Š hidden (éš±è—)
          Object.values(this.elements.screens).forEach((el) =>
            el.classList.add("hidden")
          );
          // å†æŠŠæŒ‡å®šçš„ç•«é¢ç§»é™¤ hidden (é¡¯ç¤º)
          this.elements.screens[name].classList.remove("hidden");
        },

        /*
           === [GSB å®‰å…¨] åŒ¯å‡ºè³‡æ–™åŠŸèƒ½ ===
           åƒè€ƒä¾†æºï¼šã€Šå¦‚ä½•é¿å…ç¶²ç«™è¢«GSBåˆ¤æ–·ç‚ºå±éšªç¶²ç«™ã€‹ç¬¬ 6.1 ç¯€
           1. å»ºç«‹ CSV ç´”æ–‡å­—æ ¼å¼å­—ä¸² (å®‰å…¨çš„æ–‡å­—æª”)ã€‚
           2. å»ºç«‹ä¸€å€‹ <a> é€£çµï¼Œä¸¦è§¸ç™¼é»æ“Šã€‚
           3. é€™æ¨£çš„ã€Œä½¿ç”¨è€…è§¸ç™¼ä¸‹è¼‰ã€ç¬¦åˆå®‰å…¨è¦ç¯„ï¼Œä¸æœƒè¢«èª¤åˆ¤ç‚ºè‡ªå‹•ä¸‹è¼‰æƒ¡æ„è»Ÿé«”ã€‚
        */
        exportData: function () {
          let csv =
            "data:text/csv;charset=utf-8,Round,Trial,Stimulus,InputKey,Correct,RT(ms)\n";
          this.state.results.forEach((r) => {
            csv += `${r.round},${r.trial},${r.stimulus},${r.input},${r.correct},${r.rt}\n`;
          });
          const encodedUri = encodeURI(csv);
          const link = document.createElement("a");
          link.setAttribute("href", encodedUri);
          link.setAttribute("download", "ef_training_data.csv"); // è¨­å®šä¸‹è¼‰æª”å
          document.body.appendChild(link);
          link.click(); // æ¨¡æ“¬é»æ“Šä¸‹è¼‰
          document.body.removeChild(link); // ä¸‹è¼‰å®Œç§»é™¤é€£çµ
        },
      };

      /* === [è‰¯å¥½å¯¦è¸] å…¨åŸŸäº‹ä»¶ç›£è½ ===
         æˆ‘å€‘åœ¨æ•´å€‹æ–‡ä»¶ (document) ä¸Šç›£è½æŒ‰éµï¼Œè€Œä¸æ˜¯å€‹åˆ¥æŒ‰éˆ•ã€‚
         é€™æ¨£åªè¦å¯«ä¸€æ¬¡ï¼Œå°±å¯ä»¥ç®¡ç†æ‰€æœ‰æŒ‰éµè¡Œç‚ºã€‚
      */
      document.addEventListener("keydown", function (event) {
        // æª¢æŸ¥æ˜¯å¦æŒ‰ä¸‹äº†ç©ºç™½éµ (Space)
        if (event.code === "Space" || event.key === " ") {
          const screens = game.elements.screens;
          // æ ¹æ“šç›®å‰é¡¯ç¤ºçš„ç•«é¢ï¼Œæ±ºå®šç©ºç™½éµè¦è§¸ç™¼ä»€éº¼åŠŸèƒ½
          if (!screens.intro.classList.contains("hidden")) {
            event.preventDefault(); // é˜²æ­¢ç¶²é æ²å‹•
            game.startPractice();
            return;
          }
          if (!screens.practiceEnd.classList.contains("hidden")) {
            event.preventDefault();
            game.startRound1();
            return;
          }
          if (!screens.intermission.classList.contains("hidden")) {
            event.preventDefault();
            game.startRound2();
            return;
          }
        }
        // å¦‚æœéŠæˆ²æ²’åœ¨é€²è¡Œä¸­ï¼Œå°±ä¸ç†æœƒ F/J éµ
        if (!game.state.isPlaying) return;
        const key = event.key.toUpperCase();
        if (key === "J" || key === "F") {
          game.handleInput(key);
        }
      });
    </script>
  </body>
</html>
