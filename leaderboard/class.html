<!doctype html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ç­ç´šæ’è¡Œæ¦œ - åŸ·è¡ŒåŠŸèƒ½è¨“ç·´éŠæˆ²</title>
    <link rel="stylesheet" href="../css/main.css" />
    <style>
      .leaderboard-container {
        max-width: 1000px;
        margin: 2rem auto;
        padding: 2rem;
      }

      .class-selector {
        display: flex;
        justify-content: center;
        gap: 1rem;
        margin-bottom: 2rem;
        flex-wrap: wrap;
      }

      .class-btn {
        padding: 0.75rem 1.5rem;
        border: 2px solid #ddd;
        border-radius: 8px;
        background: white;
        cursor: pointer;
        transition: all 0.3s;
        font-weight: bold;
      }

      .class-btn:hover {
        background: #f8f9fa;
      }

      .class-btn.active {
        background: #4caf50;
        color: white;
        border-color: #4caf50;
      }

      .leaderboard-table {
        background: white;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .table-header {
        display: grid;
        grid-template-columns: 80px 1fr 120px 120px 120px;
        padding: 1rem;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        font-weight: bold;
      }

      .table-row {
        display: grid;
        grid-template-columns: 80px 1fr 120px 120px 120px;
        padding: 1rem;
        border-bottom: 1px solid #eee;
        transition: all 0.3s;
      }

      .table-row:hover {
        background: #f8f9fa;
      }

      .table-row:last-child {
        border-bottom: none;
      }

      .rank {
        font-size: 1.5rem;
        font-weight: bold;
        text-align: center;
      }

      .rank.top1 {
        color: #ffd700;
      }

      .rank.top2 {
        color: #c0c0c0;
      }

      .rank.top3 {
        color: #cd7f32;
      }

      .player-info {
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .player-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: linear-gradient(135deg, #667eea, #764ba2);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: 1.2rem;
      }

      .player-name {
        font-weight: 500;
      }

      .score-cell {
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        color: #4caf50;
      }

      .games-cell {
        display: flex;
        align-items: center;
        justify-content: center;
        color: #666;
      }

      .accuracy-cell {
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .accuracy-bar {
        width: 80px;
        height: 8px;
        background: #eee;
        border-radius: 4px;
        overflow: hidden;
        margin-right: 0.5rem;
      }

      .accuracy-fill {
        height: 100%;
        background: linear-gradient(90deg, #4caf50, #8bc34a);
        transition: width 0.5s;
      }

      .empty-state {
        text-align: center;
        padding: 3rem;
        color: #999;
      }

      .empty-state .emoji {
        font-size: 4rem;
        margin-bottom: 1rem;
      }

      .stats-summary {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-bottom: 2rem;
      }

      .stat-card {
        background: white;
        padding: 1.5rem;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        text-align: center;
      }

      .stat-card .emoji {
        font-size: 2rem;
        margin-bottom: 0.5rem;
      }

      .stat-card .number {
        font-size: 2rem;
        font-weight: bold;
        color: #4caf50;
        margin-bottom: 0.25rem;
      }

      .stat-card .label {
        color: #666;
        font-size: 0.9rem;
      }

      .action-buttons {
        display: flex;
        gap: 1rem;
        justify-content: center;
        margin-top: 2rem;
      }

      @media (max-width: 768px) {
        .table-header,
        .table-row {
          grid-template-columns: 60px 1fr 80px;
        }

        .games-cell,
        .accuracy-cell {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>ğŸ† ç­ç´šæ’è¡Œæ¦œ</h1>
        <p class="subtitle">æŸ¥çœ‹ç­ç´šå…§çš„éŠæˆ²æˆç¸¾æ’å</p>
      </header>

      <main class="leaderboard-container">
        <!-- ç­ç´šé¸æ“‡å™¨ -->
        <div class="class-selector">
          <button class="class-btn active" onclick="selectClass('all')">
            å…¨éƒ¨ç­ç´š
          </button>
          <button class="class-btn" onclick="selectClass('class-a')">
            å‘æ—¥è‘µç­
          </button>
          <button class="class-btn" onclick="selectClass('class-b')">
            è–°è¡£è‰ç­
          </button>
          <button class="class-btn" onclick="selectClass('class-c')">
            ç«ç‘°ç­
          </button>
        </div>

        <!-- çµ±è¨ˆæ‘˜è¦ -->
        <div class="stats-summary">
          <div class="stat-card">
            <div class="emoji">ğŸ‘¥</div>
            <div class="number" id="totalPlayers">0</div>
            <div class="label">åƒèˆ‡äººæ•¸</div>
          </div>
          <div class="stat-card">
            <div class="emoji">ğŸ®</div>
            <div class="number" id="totalGames">0</div>
            <div class="label">ç¸½éŠæˆ²å ´æ¬¡</div>
          </div>
          <div class="stat-card">
            <div class="emoji">â­</div>
            <div class="number" id="avgScore">0</div>
            <div class="label">å¹³å‡åˆ†æ•¸</div>
          </div>
          <div class="stat-card">
            <div class="emoji">ğŸ¯</div>
            <div class="number" id="avgAccuracy">0%</div>
            <div class="label">å¹³å‡æ­£ç¢ºç‡</div>
          </div>
        </div>

        <!-- æ’è¡Œæ¦œè¡¨æ ¼ -->
        <div class="leaderboard-table">
          <div class="table-header">
            <div>æ’å</div>
            <div>ç©å®¶</div>
            <div class="games-cell">éŠæˆ²æ¬¡æ•¸</div>
            <div>æœ€é«˜åˆ†</div>
            <div class="accuracy-cell">æ­£ç¢ºç‡</div>
          </div>
          <div id="leaderboardBody"></div>
        </div>

        <div class="action-buttons">
          <button class="btn-secondary" onclick="location.href = '../index.html'">
            è¿”å›é¦–é 
          </button>
          <button class="btn-primary" onclick="refreshLeaderboard()">
            ğŸ”„ é‡æ–°æ•´ç†
          </button>
        </div>
      </main>

      <footer>
        <p>&copy; 2026 åŸ·è¡ŒåŠŸèƒ½è¨“ç·´éŠæˆ². All rights reserved.</p>
      </footer>
    </div>

    <script src="../js/firebase-config.js"></script>
    <script>
      let currentClass = 'all';

      // æ¨¡æ“¬è³‡æ–™ï¼ˆå¯¦éš›æ‡‰å¾ Firebase è¼‰å…¥ï¼‰
      const mockData = [
        {
          id: 1,
          name: 'å°æ˜',
          class: 'class-a',
          bestScore: 950,
          gamesPlayed: 15,
          accuracy: 95,
        },
        {
          id: 2,
          name: 'å°è¯',
          class: 'class-a',
          bestScore: 920,
          gamesPlayed: 12,
          accuracy: 92,
        },
        {
          id: 3,
          name: 'å°ç¾',
          class: 'class-b',
          bestScore: 890,
          gamesPlayed: 18,
          accuracy: 89,
        },
        {
          id: 4,
          name: 'å°å¼·',
          class: 'class-b',
          bestScore: 870,
          gamesPlayed: 10,
          accuracy: 87,
        },
        {
          id: 5,
          name: 'å°èŠ³',
          class: 'class-c',
          bestScore: 850,
          gamesPlayed: 14,
          accuracy: 85,
        },
        {
          id: 6,
          name: 'å°å‚‘',
          class: 'class-a',
          bestScore: 830,
          gamesPlayed: 11,
          accuracy: 83,
        },
        {
          id: 7,
          name: 'å°ç²',
          class: 'class-c',
          bestScore: 810,
          gamesPlayed: 13,
          accuracy: 81,
        },
        {
          id: 8,
          name: 'å°å®‡',
          class: 'class-b',
          bestScore: 790,
          gamesPlayed: 9,
          accuracy: 79,
        },
      ];

      function selectClass(className) {
        currentClass = className;

        // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
        document.querySelectorAll('.class-btn').forEach((btn) => {
          btn.classList.remove('active');
        });
        event.target.classList.add('active');

        renderLeaderboard();
      }

      function renderLeaderboard() {
        const filteredData =
          currentClass === 'all' ? mockData : mockData.filter((p) => p.class === currentClass);

        // æŒ‰åˆ†æ•¸æ’åº
        const sortedData = [...filteredData].sort((a, b) => b.bestScore - a.bestScore);

        const body = document.getElementById('leaderboardBody');

        if (sortedData.length === 0) {
          body.innerHTML = `
          <div class="empty-state">
            <div class="emoji">ğŸ“­</div>
            <h3>ç›®å‰æ²’æœ‰è³‡æ–™</h3>
            <p>é€™å€‹ç­ç´šé‚„æ²’æœ‰ç©å®¶è¨˜éŒ„</p>
          </div>
        `;
          updateStats(filteredData);
          return;
        }

        body.innerHTML = sortedData
          .map((player, index) => {
            const rank = index + 1;
            const rankClass = rank === 1 ? 'top1' : rank === 2 ? 'top2' : rank === 3 ? 'top3' : '';
            const rankEmoji = rank === 1 ? 'ğŸ¥‡' : rank === 2 ? 'ğŸ¥ˆ' : rank === 3 ? 'ğŸ¥‰' : rank;

            return `
            <div class="table-row">
              <div class="rank ${rankClass}">${rankEmoji}</div>
              <div class="player-info">
                <div class="player-avatar">${player.name.charAt(0)}</div>
                <div class="player-name">${player.name}</div>
              </div>
              <div class="games-cell">${player.gamesPlayed} å ´</div>
              <div class="score-cell">${player.bestScore} åˆ†</div>
              <div class="accuracy-cell">
                <div class="accuracy-bar">
                  <div class="accuracy-fill" style="width: ${player.accuracy}%"></div>
                </div>
                ${player.accuracy}%
              </div>
            </div>
          `;
          })
          .join('');

        updateStats(filteredData);
      }

      function updateStats(data) {
        if (data.length === 0) {
          document.getElementById('totalPlayers').textContent = '0';
          document.getElementById('totalGames').textContent = '0';
          document.getElementById('avgScore').textContent = '0';
          document.getElementById('avgAccuracy').textContent = '0%';
          return;
        }

        const totalPlayers = data.length;
        const totalGames = data.reduce((sum, p) => sum + p.gamesPlayed, 0);
        const avgScore = Math.round(data.reduce((sum, p) => sum + p.bestScore, 0) / totalPlayers);
        const avgAccuracy = Math.round(
          data.reduce((sum, p) => sum + p.accuracy, 0) / totalPlayers
        );

        document.getElementById('totalPlayers').textContent = totalPlayers;
        document.getElementById('totalGames').textContent = totalGames;
        document.getElementById('avgScore').textContent = avgScore;
        document.getElementById('avgAccuracy').textContent = `${avgAccuracy}%`;
      }

      function refreshLeaderboard() {
        // TODO: å¾ Firebase é‡æ–°è¼‰å…¥è³‡æ–™
        renderLeaderboard();
        alert('âœ… æ’è¡Œæ¦œå·²æ›´æ–°ï¼');
      }

      // åˆå§‹åŒ–
      renderLeaderboard();

      // TODO: æ•´åˆ Firebase å³æ™‚è³‡æ–™
      // firebase.database().ref('leaderboard').on('value', (snapshot) => {
      //   const data = snapshot.val();
      //   // æ›´æ–°æ’è¡Œæ¦œ
      // });
    </script>
  </body>
</html>
