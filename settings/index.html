<!doctype html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; media-src 'self'; connect-src 'self'"
    />
    <title>設定 - 執行功能訓練遊戲</title>
    <link rel="icon" href="../favicon.svg" type="image/svg+xml" />
    <link rel="apple-touch-icon" href="../favicon.svg" />
    <link rel="manifest" href="../manifest.json" />
    <meta name="theme-color" content="#302b63" />
    <link rel="stylesheet" href="../css/themes/base.css" />
    <link rel="stylesheet" href="../css/main.css" />
    <link rel="preload" href="../css/components/navbar.css" as="style" onload="this.rel='stylesheet'" />
    <noscript><link rel="stylesheet" href="../css/components/navbar.css" /></noscript>
    <link rel="preload" href="../css/components/landscape-hint.css" as="style" onload="this.rel='stylesheet'" />
    <noscript><link rel="stylesheet" href="../css/components/landscape-hint.css" /></noscript>
    <link rel="stylesheet" href="../css/pages/settings.css" />
    <!-- === Scripts === -->
    <script defer src="../js/utils/storage.js"></script>
    <script defer src="../js/shared/audio-player.js"></script>
    <script defer src="../js/shared/navbar.js"></script>
    <script defer src="../js/shared/landscape-hint.js"></script>
    <script defer src="../js/singleplayer/settings-controller.js"></script>
  </head>
  <body>
    <main class="settings-page" id="main-content">
      <h1>⚙️ 設定</h1>

      <!-- ==================== -->
      <!-- 👤 玩家資訊           -->
      <!-- ==================== -->
      <div class="settings-section" id="sectionPlayerInfo">
        <h2>👤 玩家資訊</h2>
        <div class="settings-item">
          <span class="settings-item__label">座號</span>
          <span class="settings-item__value" id="infoSeatNumber">--</span>
        </div>
        <div class="settings-item">
          <span class="settings-item__label">暱稱</span>
          <span class="settings-item__value" id="infoNickname">--</span>
        </div>
        <div class="settings-item">
          <span class="settings-item__label">等級</span>
          <span class="settings-item__value" id="infoLevel">--</span>
        </div>
        <div class="settings-item">
          <span class="settings-item__label">⭐ 總星星</span>
          <span class="settings-item__value" id="infoTotalStars">--</span>
        </div>
        <div class="settings-item">
          <span class="settings-item__label">⭐ 可用星星</span>
          <span class="settings-item__value" id="infoAvailStars">--</span>
        </div>
        <div class="settings-item">
          <span class="settings-item__label">🏅 徽章數</span>
          <span class="settings-item__value" id="infoBadgeCount">--</span>
        </div>
        <div class="settings-item" id="guestInfoRow" style="display: none">
          <span class="settings-item__label">身份</span>
          <span class="guest-badge">👤 訪客模式</span>
        </div>
      </div>

      <!-- ==================== -->
      <!-- 🔊 音效設定           -->
      <!-- ==================== -->
      <div class="settings-section">
        <h2>🔊 音效設定</h2>
        <!-- 主音量 -->
        <div class="volume-row">
          <span class="volume-row__label">🔊 音量</span>
          <input
            type="range"
            id="volumeSlider"
            class="volume-row__slider"
            min="0"
            max="100"
            value="80"
            aria-label="主音量"
          />
          <span class="volume-row__percent" id="volumePercent">80%</span>
        </div>
        <!-- 音效開關 -->
        <div class="settings-item">
          <span class="settings-item__label">🎵 音效</span>
          <label class="toggle-switch">
            <input type="checkbox" id="sfxToggle" checked aria-label="音效開關" />
            <span class="toggle-switch__track"></span>
          </label>
        </div>
        <!-- 語音開關 -->
        <div class="settings-item">
          <span class="settings-item__label">🗣️ 語音</span>
          <label class="toggle-switch">
            <input type="checkbox" id="voiceToggle" checked aria-label="語音開關" />
            <span class="toggle-switch__track"></span>
          </label>
        </div>
        <!-- 語速 -->
        <div class="settings-item">
          <span class="settings-item__label">🗣️ 語速</span>
          <div class="rate-selector" id="rateSelector">
            <button class="rate-btn" data-rate="0.7">🐢 慢</button>
            <button class="rate-btn active" data-rate="1.0">🐇 正常</button>
            <button class="rate-btn" data-rate="1.2">🐆 快</button>
          </div>
        </div>
      </div>

      <!-- ==================== -->
      <!-- 🎯 遊戲設定           -->
      <!-- ==================== -->
      <div class="settings-section">
        <h2>🎯 遊戲設定</h2>
        <!-- 題數設定 -->
        <div class="settings-item">
          <span class="settings-item__label">📝 每回合題數</span>
          <div class="count-selector" id="countSelector">
            <button class="count-btn" data-count="4">4</button>
            <button class="count-btn active" data-count="6">6</button>
            <button class="count-btn" data-count="8">8</button>
            <button class="count-btn" data-count="10">10</button>
          </div>
        </div>
      </div>

      <!-- ==================== -->
      <!-- 🎨 配色主題           -->
      <!-- ==================== -->
      <div class="settings-section">
        <h2>🎨 配色主題</h2>
        <div class="theme-selector" id="themeSelector">
          <button class="theme-option active" data-theme="field-primary" aria-pressed="true">
            <span class="theme-option__preview theme-option__preview--field"></span>
            <span class="theme-option__name">遊戲場配色</span>
            <span class="theme-option__desc">顏色隨遊戲場改變</span>
          </button>
          <button class="theme-option" data-theme="rule-independent" aria-pressed="false">
            <span class="theme-option__preview theme-option__preview--rule"></span>
            <span class="theme-option__name">規則配色</span>
            <span class="theme-option__desc">統一色系，不隨遊戲場變</span>
          </button>
        </div>
      </div>

      <!-- ==================== -->
      <!-- 🗄️ 資料管理           -->
      <!-- ==================== -->
      <div class="settings-section">
        <h2>🗄️ 資料管理</h2>
        <button class="settings-btn settings-btn--export" id="btnExport">
          📤 匯出遊戲紀錄
        </button>
        <button class="settings-btn settings-btn--import" id="btnImport">
          📥 匯入遊戲紀錄
        </button>
        <button class="settings-btn settings-btn--danger" id="btnClearAll">
          🗑️ 清除所有資料
        </button>
        <input type="file" id="importFileInput" accept=".json" aria-label="選擇 JSON 備份檔" />
      </div>

      <!-- ==================== -->
      <!-- � 我的統計           -->
      <!-- ==================== -->
      <div class="settings-section">
        <h2>📈 我的統計</h2>
        <a
          href="../singleplayer/stats.html"
          class="settings-btn"
          style="
            background: rgba(79, 195, 247, 0.2);
            color: #4fc3f7;
            border: 1px solid rgba(79, 195, 247, 0.3);
            text-decoration: none;
          "
        >
          📊 查看個人統計
        </a>
        <p
          style="
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.65);
            text-align: center;
            margin-top: 6px;
            line-height: 1.4;
          "
        >
          探險進度、規則表現、徽章收集一覽
        </p>
      </div>

      <!-- ==================== -->
      <!-- �👩‍🏫 教師專區           -->
      <!-- ==================== -->
      <div class="settings-section">
        <h2>👩‍🏫 教師專區</h2>
        <a
          href="../management/index.html"
          class="settings-btn"
          style="
            background: rgba(155, 89, 182, 0.2);
            color: #9b59b6;
            border: 1px solid rgba(155, 89, 182, 0.3);
            text-decoration: none;
          "
        >
          🏫 教師管理後台
        </a>
        <p
          style="
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.65);
            text-align: center;
            margin-top: 6px;
            line-height: 1.4;
          "
        >
          班級管理、學生進度查看、資料匯出
        </p>
      </div>

      <!-- ==================== -->
      <!-- ℹ️ 關於               -->
      <!-- ==================== -->
      <div class="settings-section">
        <h2>ℹ️ 關於</h2>
        <div class="settings-item">
          <span class="settings-item__label">版本</span>
          <span class="settings-item__value">v5.0</span>
        </div>
        <div class="settings-item">
          <span class="settings-item__label">開發者</span>
          <span class="settings-item__value">Patience Lee</span>
        </div>
        <div class="settings-item">
          <span class="settings-item__label">專案</span>
          <span class="settings-item__value">執行功能訓練遊戲</span>
        </div>
        <a
          href="../privacy.html"
          class="settings-item"
          style="text-decoration: none; cursor: pointer"
        >
          <span class="settings-item__label">隱私權政策</span>
          <span
            class="settings-item__value"
            style="color: rgba(168, 237, 234, 0.8)"
            >查看 →</span
          >
        </a>
      </div>
    </div>

    <!-- Toast 提示 -->
    <div class="settings-toast" id="toast" role="status" aria-live="polite"></div>

    <!-- 確認彈窗 -->
    <div class="confirm-overlay" id="confirmOverlay" role="dialog" aria-modal="true" aria-label="確認操作">
      <div class="confirm-dialog">
        <div class="confirm-dialog__icon" id="confirmIcon">⚠️</div>
        <div class="confirm-dialog__title" id="confirmTitle">確認操作</div>
        <div class="confirm-dialog__msg" id="confirmMsg">確定要執行嗎？</div>
        <div class="confirm-dialog__actions">
          <button
            class="confirm-dialog__btn confirm-dialog__btn--cancel"
            id="confirmCancel"
          >
            取消
          </button>
          <button
            class="confirm-dialog__btn confirm-dialog__btn--danger"
            id="confirmOk"
          >
            確定
          </button>
        </div>
      </div>
    </main>
  </body>
</html>
