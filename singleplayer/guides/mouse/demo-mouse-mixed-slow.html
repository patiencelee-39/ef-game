<!--
  ============================================================
  ğŸ“„ demo-mouse-mixed-slow.html
  ğŸ“ å°è€é¼ éŠæˆ²å ´ æ··åˆè¦å‰‡ ç¤ºç¯„å‹•ç•«ï¼ˆæ…¢ç‰ˆ Bï¼‰
  ğŸ¯ 4-6 æ­²å­¸å‰å¹¼å…’ï¼ˆå«è½æå…’ï¼‰
  ğŸ“ å°æ‡‰ï¼šindex-0204v14.html ç¬¬äºŒå›åˆï¼ˆDCCS é‚Šæ¡†æ¢ä»¶ï¼‰
  ğŸ« ä¸­åŸå¤§å­¸ç‰¹æ®Šæ•™è‚²å­¸ç³»
  ============================================================

  ã€æ··åˆè¦å‰‡èªªæ˜ã€‘
  æ²’äººæ™‚ = Rule1ï¼šğŸ§€èµ·å¸â†’Goï¼ŒğŸ˜ºè²“â†’NoGo
  æœ‰äººæ™‚ = Rule2ï¼šğŸ˜ºè²“â†’Goï¼ŒğŸ§€èµ·å¸â†’NoGo

  ã€ç¤ºç¯„æµç¨‹ï¼ˆ4 å€‹å ´æ™¯ï¼‰ã€‘
  å ´æ™¯ Aï¼šæ²’äºº + èµ·å¸ = Go â†’ é»æ“Š Ã—1
  å ´æ™¯ Bï¼šæ²’äºº + è²“å’ª = NoGo â†’ HandStop æ¨é–‹ Ã—1
  å ´æ™¯ Cï¼šæœ‰äºº + è²“å’ª = Go â†’ é»æ“Š Ã—1
  å ´æ™¯ Dï¼šæœ‰äºº + èµ·å¸ = NoGo â†’ HandStop æ¨é–‹ Ã—1
-->
<!doctype html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>ç¤ºç¯„å‹•ç•« - å°è€é¼ å ´ æ··åˆè¦å‰‡ï¼ˆæ…¢ç‰ˆï¼‰</title>
    <style>
      :root {
        --bg-color: #2c3e50;
        --game-bg: #34495e;
        --text-color: #ecf0f1;
        --primary-color: #3498db;
        --success-color: #2ecc71;
        --person-border: #ff6b6b;
      }
      *,
      *::before,
      *::after {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        font-family:
          "å¾®è»Ÿæ­£é»‘é«”", "Microsoft JhengHei", "PingFang TC", sans-serif;
        background-color: var(--bg-color);
        color: var(--text-color);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        overflow: hidden;
      }

      .demo-container {
        background-color: var(--game-bg);
        border-radius: 15px;
        width: 100%;
        max-width: 420px;
        min-height: 580px;
        position: relative;
        overflow: hidden;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        display: flex;
        flex-direction: column;
        align-items: center;
        /* é‚Šæ¡†ï¼šæœ‰äººæ™‚è®Šç´…ï¼Œæ²’äººæ™‚é€æ˜ */
        border: 5px solid transparent;
        transition: border-color 0.4s;
      }
      .demo-container.has-person {
        border-color: var(--person-border);
      }

      .stimulus-container {
        position: relative;
        width: 300px;
        height: 400px;
        margin: 10px auto 0;
      }
      .background-layer {
        position: absolute;
        width: 100%;
        height: 100%;
        z-index: 1;
        top: 0;
        left: 0;
      }
      .stimulus {
        position: absolute;
        z-index: 10;
        width: 120px;
        height: 120px;
        bottom: 50px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        justify-content: center;
        align-items: center;
        opacity: 0;
      }
      .stimulus svg {
        width: 100%;
        height: 100%;
        filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.3));
      }

      /* äººç‰©æŒ‡ç¤ºå™¨ï¼ˆå³ä¸Šè§’ï¼Œèˆ‡éŠæˆ²ä¸€è‡´ä½ç½®èª¿æ•´ç‚ºå³ä¸Šï¼‰ */
      .person-indicator {
        position: absolute;
        width: 120px;
        height: 120px;
        top: 10px;
        right: 10px;
        z-index: 15;
        opacity: 0;
        transition: opacity 0.4s;
        pointer-events: none;
      }
      .person-indicator svg {
        width: 100%;
        height: 100%;
        filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.5));
      }

      .controls-area {
        width: 100%;
        display: flex;
        justify-content: center;
        padding: 10px 0 15px;
      }
      .btn-key {
        width: 200px;
        height: 120px;
        border: none;
        border-radius: 15px;
        font-size: 2.5em;
        color: white;
        cursor: default;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        box-shadow: 0 4px 0 rgba(0, 0, 0, 0.2);
        background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        transition:
          transform 0.1s,
          box-shadow 0.1s;
        position: relative;
      }
      .btn-key.pressed {
        transform: translateY(4px);
        box-shadow: none;
      }
      .btn-key.glow {
        box-shadow:
          0 0 20px rgba(52, 152, 219, 0.8),
          0 0 40px rgba(46, 204, 113, 0.4);
      }
      .key-hint {
        font-size: 1rem;
        opacity: 0.8;
        margin-bottom: 5px;
        font-weight: bold;
      }
      .btn-label {
        font-size: 1.5rem;
        font-weight: bold;
      }

      .hand-layer {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 50;
        pointer-events: none;
        overflow: visible;
      }
      .hand {
        position: absolute;
        width: 80px;
        height: 100px;
        opacity: 0;
        will-change: transform, opacity, top, left;
      }
      .hand-finger {
        left: 440px;
        top: 420px;
      }
      .hand-stop {
        left: -100px;
        top: 400px;
      }
      .hand svg {
        width: 100%;
        height: 100%;
        filter: drop-shadow(2px 4px 6px rgba(0, 0, 0, 0.3));
      }

      .checkmark {
        position: absolute;
        z-index: 20;
        font-size: 60px;
        bottom: 175px;
        left: 50%;
        transform: translateX(-50%) scale(0);
        opacity: 0;
        will-change: transform, opacity;
      }
      @keyframes popIn {
        0% {
          transform: translateX(-50%) scale(0);
          opacity: 0;
        }
        50% {
          transform: translateX(-50%) scale(1.3);
          opacity: 1;
        }
        100% {
          transform: translateX(-50%) scale(1);
          opacity: 1;
        }
      }
      @keyframes fadeOut {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      .checkmark.show {
        animation: popIn 0.3s ease-out forwards;
      }
      .checkmark.hide {
        animation: fadeOut 0.2s ease-out forwards;
      }

      @keyframes shakeHand {
        0% {
          transform: rotate(0deg);
        }
        12.5% {
          transform: rotate(-45deg);
        }
        25% {
          transform: rotate(45deg);
        }
        37.5% {
          transform: rotate(-45deg);
        }
        50% {
          transform: rotate(45deg);
        }
        62.5% {
          transform: rotate(-45deg);
        }
        75% {
          transform: rotate(45deg);
        }
        87.5% {
          transform: rotate(-45deg);
        }
        100% {
          transform: rotate(0deg);
        }
      }

      .progress-bar {
        width: 90%;
        height: 4px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 2px;
        margin: 5px auto 10px;
        overflow: hidden;
      }
      .progress-fill {
        height: 100%;
        width: 0%;
        border-radius: 2px;
        transition: width 0.3s linear;
      }
      .progress-fill.go {
        background: var(--success-color);
      }
      .progress-fill.nogo {
        background: #e74c3c;
      }
      .phase-label {
        font-size: 0.75rem;
        color: rgba(255, 255, 255, 0.4);
        margin-bottom: 8px;
        min-height: 1.2em;
      }

      /* === å£è¨£æ©«å¹… === */
      .mnemonic-banner {
        width: 100%;
        padding: 8px 12px;
        text-align: center;
        background: linear-gradient(
          135deg,
          rgba(52, 152, 219, 0.25),
          rgba(46, 204, 113, 0.18)
        );
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        font-size: 1.05rem;
        font-weight: 700;
        letter-spacing: 0.5px;
        white-space: pre-line;
        line-height: 1.5;
        display: none;
      }

      /* === å®Œæˆæ§åˆ¶è¦†è“‹ === */
      .guide-done-overlay {
        position: absolute;
        inset: 0;
        z-index: 100;
        background: rgba(44, 62, 80, 0.92);
        display: none;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 16px;
        border-radius: 15px;
      }
      .guide-done-overlay.show {
        display: flex;
      }
      .guide-done-title {
        font-size: 1.3rem;
        font-weight: 700;
      }
      .guide-done-mnemonic {
        font-size: 1.1rem;
        font-weight: 600;
        text-align: center;
        padding: 10px 18px;
        border-radius: 10px;
        white-space: pre-line;
        line-height: 1.6;
        background: rgba(52, 152, 219, 0.15);
        border: 1px solid rgba(52, 152, 219, 0.3);
      }
      .guide-btn {
        padding: 12px 28px;
        border: none;
        border-radius: 12px;
        font-size: 1.05rem;
        font-weight: 700;
        cursor: pointer;
        color: #fff;
        transition:
          transform 0.15s,
          box-shadow 0.15s;
      }
      .guide-btn:active {
        transform: scale(0.96);
      }
      .guide-btn-ready {
        background: linear-gradient(135deg, #2ecc71, #27ae60);
        box-shadow: 0 4px 12px rgba(46, 204, 113, 0.4);
      }
      .guide-btn-replay {
        background: rgba(255, 255, 255, 0.12);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }
      .guide-btn-skip {
        position: absolute;
        top: 12px;
        right: 12px;
        z-index: 110;
        background: rgba(255, 255, 255, 0.25);
        border: 2px solid rgba(255, 255, 255, 0.5);
        color: #fff;
        padding: 10px 22px;
        border-radius: 12px;
        font-size: 1rem;
        font-weight: 700;
        cursor: pointer;
        display: none;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.25);
        transition:
          background 0.15s,
          transform 0.1s;
      }
      .guide-btn-skip:hover {
        background: rgba(255, 255, 255, 0.4);
        transform: scale(1.05);
      }
      .guide-btn-skip:active {
        transform: scale(0.97);
      }
    </style>
  </head>
  <body>
    <div class="demo-container" id="demoContainer">
      <div class="stimulus-container">
        <div class="background-layer" id="bgLayer"></div>
        <div class="stimulus" id="cheeseStimulus"></div>
        <div class="stimulus" id="catStimulus"></div>
        <div class="checkmark" id="checkmark">âœ…</div>
        <!-- äººç‰©æŒ‡ç¤ºå™¨ï¼ˆå³ä¸Šè§’ï¼‰ -->
        <div class="person-indicator" id="personIndicator"></div>
      </div>
      <div class="controls-area">
        <div class="btn-key" id="actionBtn">
          <span class="key-hint">æŒ‰ç©ºç™½éµ(æˆ–é»æ­¤)</span>
          <span class="btn-label" id="btnLabel">è’é›†èµ·å¸</span>
        </div>
      </div>
      <div class="phase-label" id="phaseLabel"></div>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="hand-layer">
        <div class="hand hand-finger" id="handFinger"></div>
        <div class="hand hand-stop" id="handStop"></div>
      </div>
      <div class="mnemonic-banner" id="mnemonicBanner"></div>
      <div class="guide-done-overlay" id="guideDoneOverlay">
        <div class="guide-done-title">ğŸ‘€ çœ‹å®Œäº†ï¼è¨˜ä½å£è¨£ï¼š</div>
        <div class="guide-done-mnemonic" id="guideDoneMnemonic"></div>
        <button class="guide-btn guide-btn-ready" id="btnGuideReady">
          æº–å‚™å¥½äº†ï¼âœ…
        </button>
        <button class="guide-btn guide-btn-replay" id="btnGuideReplay">
          å†çœ‹ä¸€æ¬¡ ğŸ”„
        </button>
      </div>
      <button class="guide-btn-skip" id="btnGuideSkip">è·³é â©</button>
    </div>

    <script>
      // ===== SVG ç´ æ =====
      const SVG_MOUSE_HOLE = `<svg viewBox="0 0 300 400" xmlns="http://www.w3.org/2000/svg"><rect x="0" y="0" width="300" height="350" fill="#E0CCB8"/><rect x="0" y="335" width="300" height="15" fill="#bdc3c7"/><rect x="0" y="350" width="300" height="50" fill="#95a5a6"/><path d="M 110 350 L 110 300 A 40 40 0 0 1 190 300 L 190 350 Z" fill="#1a252f"/></svg>`;
      const SVG_CHEESE = `<svg viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg"><path d="M48.18 68.45L6.7 69.95s-2.63-2.63-2.25-3.57S39.18 38.6 40.49 38.79s4.32 3.38 6.76 2.25c2.44-1.13 0-7.7.75-8.63c.75-.94 27.59-15.39 29.28-16.14c1.69-.75 3.19-2.44 6.57-1.69s11.83 2.25 21.02 8.45s18.77 13.33 18.02 17.27c-.75 3.94-74.71 28.15-74.71 28.15z" fill="#ffe265"/><path d="M19.46 115.57c9.2-1.13 94.98-19.52 98.55-20.08c3.57-.56 5.82-3.94 5.82-7.7s-.94-47.49-.94-47.49s-4.13 1.31-9.01 2.44C109 43.86 69.01 53.62 53.25 57.19S12.33 67.33 9.51 67.33s-5.07-.94-5.07-.94s.75 39.04.94 41.86c.19 2.82 1.5 6.19 4.69 7.13s5.27.69 9.39.19z" fill="#feb502"/><path d="M74.97 25.56c0 2.4 2.44 3.99 6.48 3.87c4.41-.13 5.63-2.75 5.49-4.43c-.14-1.69-2.17-3.17-6.19-3.1c-3.73.07-5.78 1.55-5.78 3.66z" fill="#ff8b0d"/><path d="M29.92 55.48c-6.5 2.19-5.77 7.88-3.87 9.15c1.9 1.27 4.43 1.2 7.39.14s4.84-2.27 5.14-4.25c.28-1.88-2.18-7.23-8.66-5.04z" fill="#ed6b31"/><path d="M88.98 39.22c-4.36.2-9.18 3.33-10.98 6.34c-1.9 3.17-2.04 6.9 2.32 9.22c4.36 2.32 19.78-3.59 19.01-9.01c-.77-5.43-5.77-6.76-10.35-6.55z" fill="#ed6b31"/><path d="M73.85 83.07s6.19-4.58 6.19-7.81c0-3.24-2.67-10.89-14.01-11.47c-10.63-.55-17.18 13.94-10.21 21.4c6.97 7.46 11.19 4.08 13.8 3.38c2.61-.71 4.23-5.5 4.23-5.5z" fill="#ed6b31"/><path d="M43.23 96.09s6.15-3.85 1.43-8.07c-3.32-2.97-7.76-1.63-10.02.68c-2.89 2.96-2.11 7.67.56 9.78c2.68 2.12 8.03-2.39 8.03-2.39z" fill="#ed6b31"/><path d="M22.39 78.78s-.7-2.21-3.21-3.1c-2.82-1-7.03 2.51-5.23 6.26c1.62 3.38 5.21 2.39 5.21 2.39l3.23-5.55z" fill="#ed6b31"/><path d="M112.42 82.01c.61-.66 4.6-3.54 4.6-5.73c0-2.18-6.01-8.92-13.68-3.85s-3.66 12.74-1.55 14.01c2.11 1.27 7.96-1.54 10.63-4.43z" fill="#ed6b31"/><path d="M30.86 58.93c-4.27 1.48-5.88 4.5-4.81 5.7c1.13 1.27 3.59 2.11 7.88.56c3.32-1.2 5-3.21 4.72-5c-.2-1.3-3.92-2.6-7.79-1.26z" fill="#ff8b0d"/><path d="M16.62 78.63c-1.87 2.34-.35 5 1.41 5.63c1.76.63 4.86-1.27 4.65-4.43c-.22-3.17-4.37-3.31-6.06-1.2z" fill="#ff8b0d"/><path d="M38.37 91.38c-4.02 3.26-4.13 6.45-2.58 7.53c1.08.76 5.06 2.34 8.7-.35c2.7-1.99 2.75-6.17 1.9-8.17c-.71-1.7-4.64-1.76-8.02.99z" fill="#ff8b0d"/><path d="M62.77 73.61c-5.38 5.23-6.66 13.72-1.38 15.72c4.65 1.76 11.33.7 15.27-4.15c4.14-5.1 4.58-10.73 1.92-14.05c-3.18-3.99-11.65-1.55-15.81 2.48z" fill="#ff8b0d"/><path d="M87.22 44.43c-7.04 2.39-11.19 7.46-7.6 10c3.59 2.53 7.32 2.16 11.4.77c4.63-1.57 8.17-5.21 8.31-8.66c.11-2.83-5.91-4.22-12.11-2.11z" fill="#ff8b0d"/><path d="M106.02 76.8c-4.79 3.9-6.19 7.81-4.22 9.64s6.69 2.67 11.05-.35c4.53-3.14 4.86-6.7 4.36-9.57c-.56-3.23-6.27-3.73-11.19.28z" fill="#ff8b0d"/></svg>`;
      const SVG_CAT = `<svg viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg"><path fill="#292F33" d="M10.478 22.439s.702 2.281-.337 7.993c-.186 1.025-.46 2.072-.599 2.93c-1.757 0-1.851 2.002-1.478 2.002h2.094c1.337 0 2.971-3.334 3.854-7.961s-3.534-4.964-3.534-4.964zm13.042 3.702s2.272 1.22 2.188 4.081c-.033 1.131-.249 2.091-.355 3.024c-1.832 0-1.839 1.985-1.305 1.985h1.856c.923 0 3.001-3.158 3.379-7.281c.379-4.122-5.763-1.809-5.763-1.809z"/><path fill="#292F33" d="M36 8.447C36 3.525 31.859 1 27 1a1 1 0 1 0 0 2c1.804 0 6.717.934 6.717 5.447c0 2.881-1.567 5.462-3.77 5.982c-.164-.073-.345-.104-.509-.192c-7.239-3.917-13.457.902-15.226-.29c-1.752-1.182-.539-3.255-2.824-5.243c-.33-1.841-1.073-4.477-1.794-4.477c-.549 0-1.265 1.825-1.74 3.656c-.591-1.381-1.363-2.756-1.86-2.756c-.64 0-1.278 2.273-1.594 4.235c-1.68 1.147-2.906 2.809-2.906 4.765c0 2.7 4.05 3.357 5.4 3.411c1.35.054 3.023 3.562 3.585 5.072c1.242 4.367 2.051 8.699 2.698 11.183c-1.649 0-1.804 2.111-1.348 2.111c.713 0 1.953-.003 2.225 0c1.381.014 2.026-4.706 2.026-8.849c0-.212-.011-.627-.011-.627s1.93.505 6.038-.208c2.444-.424 5.03.849 5.746 3.163c.527 1.704 1.399 3.305 1.868 4.484c-1.589 0-1.545 2.037-1.084 2.037c.787 0 1.801.014 2.183 0c1.468-.055.643-7.574 1.03-10.097s1.267-5.578-.229-8.797C34.857 15.236 36 11.505 36 8.447z"/><circle fill="#C3C914" cx="5.994" cy="11.768" r=".9"/><path fill="#66757F" d="M2.984 12.86c-.677.423-.677 1.777-1.015 1.777S.954 13.841.954 12.86c-.001-.981 2.862-.52 2.03 0zm3.594 1.483c-.041.026-.09.036-.142.026c-.018-.004-1.548-.241-2.545.146c-.129.05-.341-.023-.413-.191s.023-.365.152-.415c1.44-.569 2.857-.234 2.934-.218c.139.029.195.19.188.372c-.004.114-.104.235-.174.28zm-.472 2.339a.186.186 0 0 1-.141-.031c-.015-.01-1.331-.83-2.402-.853c-.138-.003-.305-.154-.305-.341c0-.186.165-.335.304-.333c1.552.024 2.724.891 2.789.937c.117.082.104.255.027.424c-.049.107-.189.182-.272.197z"/><path d="M7.854 7.881s.372-.039.859.033c.217-.46.585-.887.585-.887s.281.668.386 1.179c.025.12.218.117.322.189c0 0 .038-3.463-.863-3.836c.001-.002-.755 1.124-1.289 3.322zM4.399 9.36s.384-.267.883-.574c.217-.624.568-1.333.568-1.333s.307.602.345.81c.21-.114.21-.106.403-.19c0 0-.114-2.286-1.099-2.527c0 0-.732 1.372-1.1 3.814z" fill="#7F676D"/><path fill="#66757F" d="M18.45 23.644c-2.649.57-2.38 2.782-2.38 2.782s1.93.505 6.038-.208a5.542 5.542 0 0 1 3.107.377c-1.607-3.047-4.315-3.479-6.765-2.951z"/><path fill="#292F33" d="M5.976 10.982s.333.347.319.778c-.014.43-.25.833-.25.833s-.292-.347-.319-.826c-.027-.48.25-.785.25-.785z"/></svg>`;
      const SVG_FINGER_TAP = `<svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path style="fill:#FDC794;" d="M427.677,326.621V220.69c0-16.772-14.124-35.31-30.897-35.31s-30.897,17.655-30.897,35.31V52.966c0-16.772-14.124-35.31-30.897-35.31c-16.772,0-30.897,18.538-30.897,35.31v185.379V35.31c0-16.772-14.124-35.31-30.897-35.31c-16.772,0-30.897,17.655-30.897,35.31v35.31c0-16.772-14.124-35.31-30.897-35.31s-30.897,17.655-30.897,35.31v211.862c0-24.717-21.186-74.152-44.138-97.103l0,0c-19.421-19.421-74.152-6.179-44.138,35.31c21.186,29.131,35.31,90.924,35.31,123.586c0,78.566,61.793,105.931,61.793,105.931v60.91h211.862v-60.91l0,0C429.442,411.366,427.677,414.014,427.677,326.621"/><g><path style="fill:#F9A671;" d="M304.091,440.497h-26.483c-5.297,0-8.828-3.531-8.828-8.828s3.531-8.828,8.828-8.828h26.483c5.297,0,8.828,3.531,8.828,8.828S309.387,440.497,304.091,440.497z"/><path style="fill:#F9A671;" d="M312.918,475.807H268.78c-5.297,0-8.828-3.531-8.828-8.828s3.531-8.828,8.828-8.828h44.138c5.297,0,8.828,3.531,8.828,8.828S318.215,475.807,312.918,475.807z"/><path style="fill:#F9A671;" d="M242.297,184.497c-5.297,0-8.828-3.531-8.828-8.828V60.91c0-5.297,3.531-8.828,8.828-8.828s8.828,3.531,8.828,8.828v114.759C251.125,180.966,247.594,184.497,242.297,184.497z"/><path style="fill:#F9A671;" d="M304.091,184.497c-5.297,0-8.828-3.531-8.828-8.828V43.255c0-5.297,3.531-8.828,8.828-8.828c5.297,0,8.828,3.531,8.828,8.828v132.414C312.918,180.966,309.387,184.497,304.091,184.497z"/><path style="fill:#F9A671;" d="M365.884,263.945c-5.297,0-8.828-3.531-8.828-8.828v-44.138c0-5.297,3.531-8.828,8.828-8.828c5.297,0,8.828,3.531,8.828,8.828v44.138C374.711,260.414,371.18,263.945,365.884,263.945z"/></g></svg>`;
      const SVG_HAND_STOP = `<svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><g transform="translate(-1)"><path style="fill:#FDC794;" d="M402.635,450.207c28.248-37.959,26.483-36.193,26.483-123.586V145.655c0-16.772-14.124-30.897-30.897-30.897s-30.897,14.124-30.897,30.897V256V48.552c0-16.772-14.124-30.897-30.897-30.897c-16.772,0-30.897,14.124-30.897,30.897v189.793V30.897C305.532,14.124,291.408,0,274.635,0s-30.897,14.124-30.897,30.897v198.621V66.207c0-16.772-14.124-30.897-30.897-30.897s-30.897,14.124-30.897,30.897v216.276c0-24.717-21.186-74.152-44.138-97.103l0,0c-19.421-19.421-74.152-6.179-44.138,35.31c21.186,29.131,35.31,90.924,35.31,123.586c0,78.566,61.793,105.931,61.793,105.931v35.31c0,15.007,11.476,26.483,26.483,26.483h158.897c15.007,0,26.483-11.476,26.483-26.483V450.207z"/><g><path style="fill:#F9A671;" d="M216.373,459.034h-26.483c-5.297,0-8.828-3.531-8.828-8.828c0-5.297,3.531-8.828,8.828-8.828h26.483c5.297,0,8.828,3.531,8.828,8.828C225.201,455.503,221.67,459.034,216.373,459.034z"/><path style="fill:#F9A671;" d="M401.753,459.034H384.98c-5.297,0-8.828-3.531-8.828-8.828c0-5.297,3.531-8.828,8.828-8.828h16.772c5.297,0,8.828,3.531,8.828,8.828C410.58,455.503,407.049,459.034,401.753,459.034z"/><path style="fill:#F9A671;" d="M243.739,238.345c-5.297,0-8.828-3.531-8.828-8.828V61.793c0-5.297,3.531-8.828,8.828-8.828s8.828,3.531,8.828,8.828v167.724C252.566,234.814,249.035,238.345,243.739,238.345z"/><path style="fill:#F9A671;" d="M305.532,238.345c-5.297,0-8.828-3.531-8.828-8.828V44.138c0-5.297,3.531-8.828,8.828-8.828c5.297,0,8.828,3.531,8.828,8.828v185.379C314.36,234.814,310.828,238.345,305.532,238.345z"/><path style="fill:#F9A671;" d="M367.325,264.828c-5.297,0-8.828-3.531-8.828-8.828V123.586c0-5.297,3.531-8.828,8.828-8.828s8.828,3.531,8.828,8.828V256C376.153,261.297,372.622,264.828,367.325,264.828z"/></g></g></svg>`;
      const SVG_HAND2_CLICK = `<svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path style="fill:#FDC794;" d="M425.201,347.119V242.983c0-16.488-13.885-34.712-30.373-34.712s-30.373,17.356-30.373,34.712V95.458c0-16.488-13.885-34.712-30.373-34.712s-30.373,18.224-30.373,34.712V78.102c0-16.488-13.885-34.712-30.373-34.712s-30.373,18.224-30.373,34.712v173.559V112.814c0-16.488-13.885-34.712-30.373-34.712s-30.373,18.224-30.373,34.712v190.915c0-24.298-20.827-72.895-43.39-95.458l0,0c-19.092-19.092-72.895-6.075-43.39,34.712c20.827,28.637,29.505,90.251,34.712,121.492c13.017,76.366,60.746,86.78,60.746,86.78V512h208.271v-60.746l0,0C426.936,413.939,425.201,433.031,425.201,347.119"/><path style="fill:#71C386;" d="M152.713,121.492c-4.339,0-7.81-2.603-8.678-6.942c-0.868-3.471-0.868-6.942-0.868-10.414c0-38.183,30.373-68.556,68.556-69.424C224.74,13.885,253.377,0,273.336,0c18.224,0,38.183,6.942,51.2,17.356h9.546c38.183,0,69.424,31.241,69.424,69.424c0,7.81-0.868,13.885-1.736,19.092c-0.868,4.339-6.075,7.81-10.414,6.075c-4.339-0.868-7.81-6.075-6.075-10.414c0.868-4.339,1.736-8.678,1.736-15.62c0-28.637-23.431-52.068-52.068-52.068h-13.885c-2.603,0-4.339-0.868-6.075-2.603c-8.678-8.678-26.034-14.753-41.654-14.753S232.55,29.505,224.74,45.993c-0.868,0.868-0.868,1.736-1.736,2.603c-1.736,2.603-4.339,3.471-6.942,3.471c-0.868,0-2.603,0-3.471,0c-28.637,0-52.068,23.431-52.068,52.068c0,2.603,0,4.339,0.868,6.942c0.868,4.339-1.736,9.546-6.075,10.414C154.448,121.492,153.581,121.492,152.713,121.492"/><g><path style="fill:#F9A671;" d="M303.709,442.576h-26.034c-5.207,0-8.678-3.471-8.678-8.678c0-5.207,3.471-8.678,8.678-8.678h26.034c5.207,0,8.678,3.471,8.678,8.678C312.387,439.105,308.916,442.576,303.709,442.576"/><path style="fill:#F9A671;" d="M312.387,477.288h-43.39c-5.207,0-8.678-3.471-8.678-8.678s3.471-8.678,8.678-8.678h43.39c5.207,0,8.678,3.471,8.678,8.678S317.594,477.288,312.387,477.288"/><path style="fill:#F9A671;" d="M242.964,260.339c-5.207,0-8.678-3.471-8.678-8.678V95.458c0-5.207,3.471-8.678,8.678-8.678s8.678,3.471,8.678,8.678v156.203C251.642,256.868,248.17,260.339,242.964,260.339"/><path style="fill:#F9A671;" d="M303.709,269.017c-5.207,0-8.678-3.471-8.678-8.678V86.78c0-5.207,3.471-8.678,8.678-8.678s8.678,3.471,8.678,8.678v173.559C312.387,265.546,308.916,269.017,303.709,269.017"/><path style="fill:#F9A671;" d="M364.455,286.373c-5.207,0-8.678-3.471-8.678-8.678v-52.068c0-5.207,3.471-8.678,8.678-8.678s8.678,3.471,8.678,8.678v52.068C373.133,282.902,369.662,286.373,364.455,286.373"/></g></svg>`;

      /* äººç‰© SVGï¼ˆç°¡åŒ–ç‰ˆï¼Œèµ°è·¯å°äººï¼Œå¸¶å‹•ç•«æ‰‹è…³æ“ºå‹•ï¼‰ */
      const SVG_PERSON = `<svg width="200px" height="200px" viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--noto" preserveAspectRatio="xMidYMid meet"><defs><linearGradient id="IconifyId17ecdb2904d178eab19193" gradientUnits="userSpaceOnUse" x1="51.872" y1="77.64" x2="69.122" y2="65.64" gradientTransform="matrix(1 0 0 -1 0 128)"><stop offset="0" stop-color="#f78c1f"/><stop offset=".482" stop-color="#f47f12"/><stop offset="1" stop-color="#ef6c00"/></linearGradient><linearGradient id="IconifyId17ecdb2904d178eab19194" gradientUnits="userSpaceOnUse" x1="59.199" y1="57.617" x2="56.005" y2="76.342" gradientTransform="matrix(1 0 0 -1 0 128)"><stop offset=".461" stop-color="#f9ddbd"/><stop offset="1" stop-color="#ffd29c"/></linearGradient><linearGradient id="IconifyId17ecdb2904d178eab19195" gradientUnits="userSpaceOnUse" x1="53.334" y1="44.839" x2="55.581" y2="50.692" gradientTransform="matrix(1 0 0 -1 0 128)"><stop offset=".456" stop-color="#f9ddbd"/><stop offset="1" stop-color="#ffd29c"/></linearGradient><radialGradient id="IconifyId17ecdb2904d178eab19196" cx="63.435" cy="103.503" r="7.122" gradientTransform="matrix(.9381 .3463 .4988 -1.351 -47.703 142.36)" gradientUnits="userSpaceOnUse"><stop offset=".45" stop-color="#454140" stop-opacity="0"/><stop offset="1" stop-color="#454140"/></radialGradient><radialGradient id="IconifyId17ecdb2904d178eab19197" cx="64.277" cy="110.685" r="7.219" gradientTransform="matrix(.9909 -.1344 -.1696 -1.2504 19.355 164.355)" gradientUnits="userSpaceOnUse"><stop offset=".45" stop-color="#454140" stop-opacity="0"/><stop offset="1" stop-color="#454140"/></radialGradient><radialGradient id="IconifyId17ecdb2904d178eab19198" cx="56.224" cy="113.176" r="14.858" gradientTransform="matrix(.9882 -.1534 -.1153 -.7428 13.715 107.517)" gradientUnits="userSpaceOnUse"><stop offset=".45" stop-color="#454140" stop-opacity="0"/><stop offset="1" stop-color="#454140"/></radialGradient><radialGradient id="IconifyId17ecdb2904d178eab19199" cx="65.076" cy="102.635" r="7.999" gradientTransform="matrix(.9692 .2463 .1583 -.6231 -14.242 73.291)" gradientUnits="userSpaceOnUse"><stop offset=".45" stop-color="#454140" stop-opacity="0"/><stop offset="1" stop-color="#454140"/></radialGradient></defs><g><animateTransform attributeName="transform" type="rotate" values="-25 70 70; 25 70 70; -25 70 70" dur="1s" repeatCount="indefinite" /><path d="M85.26 108.68L71.19 92.63c-.88-1-1.4-2.26-1.48-3.59l-1.38-22.46l-15.5 1.71l4.88 23.17c.79 3.75 2.9 7.09 5.94 9.42l16.49 12.6l5.12-4.8z" fill="#616161"/><path d="M89.65 111.84c.45-.45.45-1.17 0-1.62l-1.98-1.98c-1.35-1.35-4.24-1.52-4.24-1.52l-4.93 4.93l-2.97 5.91c-.65 1.5-.33 3.24.82 4.41l.89.9c.39.39 1.03.39 1.42 0l10.99-11.03z" fill="#325599"/></g><g><animateTransform attributeName="transform" type="rotate" values="25 68 63; -25 68 63; 25 68 63" dur="1s" repeatCount="indefinite" /><path d="M68.15 62.88l-17.58 1.61l-4.53 20.39c-.83 3.76-1.12 7.63-.85 11.47l1.63 23.24h6.67l2.95-25.03s5.01-13.32 5.17-13.4c4.07-1.93 7.59-4.92 7.41-9.83c-.09-2.82-.55-5.66-.87-8.45z" fill="#7c7c7c"/><path d="M54.6 123.98c.63 0 1.15-.51 1.15-1.15v-2.8c0-1.9-1.93-4.07-1.93-4.07h-6.98l-6.28 2.07c-1.52.6-2.53 2.06-2.54 3.69l-.01 1.26c0 .55.45 1 1 1H54.6z" fill="#4568ad"/></g><g><animateTransform attributeName="transform" type="translate" values="0 0; 0 -3; 0 0" dur="0.5s" repeatCount="indefinite" /><path d="M67.17 13.34c-2.51-4.06-8.2-7.22-12.91-6.44c-5.28.87-8.11 4.67-8.86 9.49c-.27 1.75-.22 3.49.08 4.72c.04.15.33 1.22.35 1.56c.2 1.3-2.32 2.59-2.61 4.02c-.22 1.08 2.03 1.77 2.21 1.96c.88.97-.51 5.58 5.66 6.04c2.37.18 1.91.03 2.61.3c1.09.42.99 3.32.99 3.32s.61 4.78 4.69 3.51c4.66-1.44 4.84-4.74 4.84-4.74s-1.73-4.6 1.05-9.38c2.21-3.82 3.52-11.75 1.9-14.36z" fill="#f9ddbd"/><path d="M46.05 31.23c.86.05 1.7-.15 2.43-.69c.79-.59.25-1.24-.66-.86c-.55.23-1.32.35-2.02.22l.25 1.33z" fill="#444"/><ellipse transform="rotate(-1.812 49.645 23.394)" cx="49.65" cy="23.39" rx="1.13" ry="1.74" fill="#312d2d"/><path d="M48.77 20.82c-1.12.26-1.34-.48-.94-1.04c.29-.42.98-.74 2.25-.42c1.2.3 1.66 1.03 1.97 1.47s.24.86-.04.89c-.38.02-1.86-1.22-3.24-.9z" fill="#454140"/><path d="M64.89 73.51h-11.9c-2.27 0-4.12-2.18-4.12-4.86l2.15-22.5c.44-4.11 2.53-8.09 4.63-9.59c1.97-1.41 4.82-1.64 4.82-1.64c1.53-.12 3.8.25 5.25 2.37c.87 1.27 1.52 3.75 1.66 5.88L69 68.65c0 2.69-1.84 4.86-4.11 4.86z" fill="url(#IconifyId17ecdb2904d178eab19193)"/><path d="M66.8 60.29l-2.25-13.83l-6.97 1.13l2.15 13.19l-3.57 9.84c-.23.45-3.46 1.91-3.66 2.01c-.62.3-1.05.89-1.37 2.06c-.19.72-.67 2.78.34 3.14c-.34.95-.12 2.14.14 2.42c.6.65 1.33.36 1.33.36s.1.83.76 1.06c.82.29 1.39-.16 1.39-.16c.29.22.64.34 1.01.34c.44 0 .83-.17 1.13-.39c.19.08.71.39 1.37-.08c.42-.3 1.74-2.03 2.15-3.14c.28-.76.24-4.58.59-5.25c.35-.67 5.14-10.2 5.14-10.2h-.01c.43-.79.53-1.68.33-2.5z" fill="url(#IconifyId17ecdb2904d178eab19194)"/><path d="M58.88 78.7c-.23-.6-.38-.64-.8-.53c-.57.15-1.19.13-1.54-.57c-.08-.17-.2-.23-.38-.17c-.61.2-1.37.21-1.63-.71c-.1-.34-.24-.38-.61-.38c-.12 0-.47.15-.83-.23c-.4-.43.14-1.29-.37-1.37c-.15-.02-.87.06-1.09-.71c-.14-.5.44-1.1.45-1.11c-.4.35-.71.9-.94 1.78c-.19.72-.67 2.78.34 3.14c-.34.95-.12 2.14.14 2.42c.6.65 1.33.36 1.33.36s.1.83.76 1.06c.82.29 1.39-.16 1.39-.16c.29.22.64.34 1.01.34c.44 0 .83-.17 1.13-.39c.19.08.71.39 1.37-.08c.35-.25 1.34-1.52 1.89-2.58c-.49.39-1.45.34-1.62-.11z" fill="url(#IconifyId17ecdb2904d178eab19195)"/><path d="M58.37 79.39c.07.49-.06.86-.24 1.22c-.2.34-.44.65-.89.86c-.07-.49.06-.86.24-1.22c.19-.34.44-.65.89-.86z" fill="#edbd82"/><path d="M56.35 78.48c.07.63-.07 1.19-.27 1.72c-.22.52-.48 1.03-.97 1.44c-.07-.64.07-1.19.27-1.72c.22-.51.49-1.02.97-1.44z" fill="#edbd82"/><path d="M53.95 77.48c.12.62.02 1.18-.13 1.72c-.17.53-.4 1.05-.85 1.5c-.12-.62-.02-1.18.13-1.72c.18-.53.41-1.05.85-1.5z" fill="#edbd82"/><path d="M53.8 73.88c-.31.27-.61.55-.86.85c-.27.3-.4.57-.49.96c-.23.74-.46 1.51-1 2.22c-.16-.87 0-1.69.33-2.47c.17-.38.5-.82.86-1.04c.37-.25.76-.42 1.16-.52z" fill="#edbd82"/><g><path d="M56.4 53l10.9-1.98l-1.76-9.69a5.538 5.538 0 0 0-6.44-4.46a5.538 5.538 0 0 0-4.46 6.44L56.4 53z" fill="#ed6d23"/></g><g><path d="M70.66 13.53c-1.32-3.31-4-4.31-4.88-4.55c-.41-1.2-2.49-5.75-10-4.51c-1.83.3-3.17 1.17-4.35 1.94c-.5.33-.98.65-1.43.86c-.37.17-1.01.33-1.54.16c-1.21-.4-.83-2.24-.83-2.24s-4.44.88-2.53 5.17c-1.49.66-2.18 2.24-2.44 3.73c-.36 2.03.63 3.96 2.58 4.83c0 0-.39-3.26 4.32-3.07c1.46.06 2.99.29 4.34-.26c.52-.21 1-.54 1.5-.78h.18c1.78.95-.56 5.16 1.42 7.62c.39.49.72.31.72.31l.79-1.17c.6-.8 1.15-1.5 1.9-1.33c2.22.49 1.82 4.45-.81 5.32c-.26.09.35 4.5 5.8 4.5c2.82 0 3.81-2.34 3.81-2.34s-1.2.3-1.46-.72c-.14-.53.35-1.25 1.23-2.03c2.54-2.26 1.62-4.86 1.25-5.67c.4-.76 1.46-3.18.43-5.77z" fill="#312d2d"/></g><path d="M70.24 19.29c.05-.09-.79 2.01-4.39 1.66c-1.48 0-3.54 3.57-1.38 5.93c1.92 2.08 4.75.83 4.75.83s-.39.11-.96-.08c-.37-.13-.5-.61-.5-.64c-.14-.53.35-1.25 1.23-2.03c2.54-2.27 1.62-4.86 1.25-5.67z" fill="url(#IconifyId17ecdb2904d178eab19196)"/><path d="M70.66 13.53c-.69-1.74-1.96-3.21-3.64-4.06c-.24-.12-.84-.41-1.25-.49c.2.77.18 1.6-.15 2.45c-.01.03-.39 1.3-1.48 2.31c.79 1.1 1.19 2.43 1.57 3.74c.33 1.14.65 2.4.14 3.47c.69-.04 1.79.15 3-.39c1.16-.52 1.77-1.86 2.05-3.06c.31-1.31.26-2.7-.24-3.97z" fill="url(#IconifyId17ecdb2904d178eab19197)"/><path d="M65.61 11.44c.87-2.23-.36-4.29-2.21-5.66c-2.18-1.61-5.04-1.73-7.62-1.31c-1.83.3-3.17 1.17-4.35 1.94c-.51.33-.99.64-1.44.86c-.37.17-1.01.33-1.54.16c-1.21-.4-.83-2.24-.83-2.24s-4.44.88-2.53 5.17c-1.49.66-2.18 2.24-2.44 3.73c-.36 2.03.63 3.96 2.58 4.83c0 0-.39-3.26 4.32-3.07c1.46.06 2.99.29 4.34-.26c1.2-.48 1.6-1.13 2.95-1.06c1.45.08 3.38.63 4.87.4c3.01-.46 3.89-3.45 3.9-3.49z" fill="url(#IconifyId17ecdb2904d178eab19198)"/><path d="M64.47 26.88c-.97-1.03-1.23-2.73-2.75-3.63c-.28.99-.99 1.92-2.12 2.3c-.26.09.35 4.5 5.8 4.5c2.82 0 3.81-2.34 3.81-2.34s-2.79 1.24-4.74-.83z" fill="url(#IconifyId17ecdb2904d178eab19199)"/></g></svg>`;

      // ===== DOM =====
      const DOM = {
        container: document.getElementById("demoContainer"),
        bgLayer: document.getElementById("bgLayer"),
        cheese: document.getElementById("cheeseStimulus"),
        cat: document.getElementById("catStimulus"),
        checkmark: document.getElementById("checkmark"),
        handFinger: document.getElementById("handFinger"),
        handStop: document.getElementById("handStop"),
        btn: document.getElementById("actionBtn"),
        btnLabel: document.getElementById("btnLabel"),
        phaseLabel: document.getElementById("phaseLabel"),
        progressFill: document.getElementById("progressFill"),
        person: document.getElementById("personIndicator"),
      };

      let timers = [];
      function schedule(fn, delay) {
        const id = setTimeout(fn, delay);
        timers.push(id);
        return id;
      }
      function clearAllTimers() {
        timers.forEach((id) => clearTimeout(id));
        timers = [];
      }

      function getBtnCenter() {
        const c = DOM.container.getBoundingClientRect();
        const b = DOM.btn.getBoundingClientRect();
        return {
          left: b.left - c.left + b.width / 2 - 40,
          top: b.top - c.top + b.height / 2 - 50,
        };
      }

      function moveHandTo(h, l, t, d, e = "cubic-bezier(0.4,0,0.2,1)") {
        h.style.transition = `left ${d}ms ${e}, top ${d}ms ${e}, opacity 0.15s`;
        h.style.left = l + "px";
        h.style.top = t + "px";
      }
      function resetFinger() {
        DOM.handFinger.style.transition = "none";
        DOM.handFinger.style.opacity = "0";
        DOM.handFinger.style.left = "440px";
        DOM.handFinger.style.top = "420px";
      }
      function resetStop() {
        DOM.handStop.style.transition = "none";
        DOM.handStop.style.opacity = "0";
        DOM.handStop.style.left = "-100px";
        DOM.handStop.style.top = "400px";
        DOM.handStop.style.animation = "none";
        DOM.handStop.style.transformOrigin = "center bottom";
      }
      function showCheck() {
        DOM.checkmark.className = "checkmark show";
      }
      function hideCheck() {
        DOM.checkmark.className = "checkmark hide";
      }
      function resetCheck() {
        DOM.checkmark.className = "checkmark";
        DOM.checkmark.style.opacity = "0";
        DOM.checkmark.style.transform = "translateX(-50%) scale(0)";
      }
      function pressBtn() {
        DOM.btn.classList.add("pressed", "glow");
      }
      function releaseBtn() {
        DOM.btn.classList.remove("pressed", "glow");
      }
      function updateProg(p, t) {
        DOM.progressFill.className = `progress-fill ${t}`;
        DOM.progressFill.style.width = p + "%";
      }

      function showPerson() {
        DOM.person.innerHTML = SVG_PERSON;
        DOM.person.style.opacity = "1";
        DOM.container.classList.add("has-person");
      }
      function hidePerson() {
        DOM.person.style.opacity = "0";
        DOM.container.classList.remove("has-person");
        DOM.person.innerHTML = "";
      }

      function resetAll() {
        DOM.cheese.style.opacity = "0";
        DOM.cat.style.opacity = "0";
        resetFinger();
        resetStop();
        resetCheck();
        releaseBtn();
        hidePerson();
        updateProg(0, "go");
        DOM.phaseLabel.textContent = "";
        DOM.btnLabel.textContent = "è’é›†èµ·å¸";
      }

      // ===== é€šç”¨ Go å ´æ™¯ï¼ˆç§»å…¥â†’é»æ“Šâ†’é€€å‡ºâ†’å‹¾å‹¾ï¼‰ =====
      function scheduleGo(startTime, stimEl, stimSvg) {
        const bp = getBtnCenter();
        schedule(() => {
          stimEl.innerHTML = stimSvg;
          stimEl.style.opacity = "1";
        }, startTime);
        // ç§»å…¥
        schedule(() => {
          resetFinger();
          DOM.handFinger.innerHTML = SVG_FINGER_TAP;
          requestAnimationFrame(() => {
            DOM.handFinger.style.opacity = "1";
            moveHandTo(DOM.handFinger, bp.left, bp.top, 800);
          });
        }, startTime + 400);
        // é»æ“Š
        schedule(() => {
          DOM.handFinger.innerHTML = SVG_HAND2_CLICK;
          DOM.handFinger.style.transition = "top 150ms ease-in";
          DOM.handFinger.style.top = bp.top + 20 + "px";
          pressBtn();
        }, startTime + 1500);
        // å›å½ˆ
        schedule(() => {
          DOM.handFinger.innerHTML = SVG_FINGER_TAP;
          DOM.handFinger.style.transition = "top 150ms ease-out";
          DOM.handFinger.style.top = bp.top + "px";
          releaseBtn();
        }, startTime + 1900);
        // é€€å‡º
        schedule(() => {
          DOM.handFinger.style.transition = "left 0.4s ease-in, opacity 0.3s";
          DOM.handFinger.style.left = "440px";
          DOM.handFinger.style.opacity = "0";
        }, startTime + 2100);
        // å‹¾å‹¾
        schedule(() => showCheck(), startTime + 2500);
        schedule(() => hideCheck(), startTime + 3300);
        schedule(() => {
          resetCheck();
          resetFinger();
        }, startTime + 3500);
        // åˆºæ¿€ç‰©æ·¡å‡º
        schedule(() => {
          stimEl.style.transition = "opacity 0.3s";
          stimEl.style.opacity = "0";
        }, startTime + 3700);
        schedule(() => {
          stimEl.style.transition = "none";
          stimEl.innerHTML = "";
        }, startTime + 4100);
      }

      // ===== é€šç”¨ NoGo å ´æ™¯ï¼ˆç§»å…¥â†’HandStopæ¨é–‹â†’å‹¾å‹¾ï¼‰ =====
      function scheduleNoGo(startTime, stimEl, stimSvg) {
        const bp = getBtnCenter();
        schedule(() => {
          stimEl.innerHTML = stimSvg;
          stimEl.style.opacity = "1";
        }, startTime);
        // FingerTap ç§»å…¥
        schedule(() => {
          resetFinger();
          DOM.handFinger.innerHTML = SVG_FINGER_TAP;
          requestAnimationFrame(() => {
            DOM.handFinger.style.opacity = "1";
            moveHandTo(
              DOM.handFinger,
              bp.left + 80,
              bp.top,
              500,
              "cubic-bezier(0.6,0,0.4,1)",
            );
          });
        }, startTime + 400);
        // HandStop è¡å…¥æ¨é–‹
        schedule(() => {
          resetStop();
          DOM.handStop.innerHTML = SVG_HAND_STOP;
          requestAnimationFrame(() => {
            DOM.handStop.style.opacity = "1";
            moveHandTo(
              DOM.handStop,
              bp.left - 10,
              bp.top - 20,
              300,
              "cubic-bezier(0.2,0,0,1)",
            );
            DOM.handStop.style.animation = "shakeHand 0.8s ease-in-out 1";
          });
          DOM.handFinger.style.transition =
            "left 0.4s cubic-bezier(0,0,0.6,1), opacity 0.3s";
          DOM.handFinger.style.left = "440px";
          DOM.handFinger.style.opacity = "0";
        }, startTime + 850);
        // HandStop é€€å‡º
        schedule(() => {
          DOM.handStop.style.animation = "none";
          DOM.handStop.style.transition = "left 0.4s ease-in, opacity 0.3s";
          DOM.handStop.style.left = "-100px";
          DOM.handStop.style.opacity = "0";
        }, startTime + 1500);
        schedule(() => resetStop(), startTime + 1850);
        // å‹¾å‹¾
        schedule(() => showCheck(), startTime + 2100);
        schedule(() => hideCheck(), startTime + 2900);
        schedule(() => {
          resetCheck();
          resetFinger();
        }, startTime + 3100);
        // åˆºæ¿€ç‰©æ·¡å‡º
        schedule(() => {
          stimEl.style.transition = "opacity 0.3s";
          stimEl.style.opacity = "0";
        }, startTime + 3300);
        schedule(() => {
          stimEl.style.transition = "none";
          stimEl.innerHTML = "";
        }, startTime + 3700);
      }

      /*
      ============================================================
      4 å ´æ™¯æ™‚é–“è»¸ï¼ˆæ¯å ´æ™¯ç´„ 4500msï¼Œé–“éš” 500msï¼‰

      å ´æ™¯ A (0ms)ï¼š     æ²’äºº + èµ·å¸ = Go
      å ´æ™¯ B (5000ms)ï¼š  æ²’äºº + è²“å’ª = NoGo
      å ´æ™¯ C (10000ms)ï¼š æœ‰äºº + è²“å’ª = Goï¼ˆè¦å‰‡åè½‰ï¼ï¼‰
      å ´æ™¯ D (15000ms)ï¼š æœ‰äºº + èµ·å¸ = NoGoï¼ˆè¦å‰‡åè½‰ï¼ï¼‰
      æ¸…å ´ (20000ms)ï¼š   å…¨éƒ¨é‡ç½®
      å¾ªç’° (21000ms)
      ============================================================
    */
      const TOTAL = 21000;

      let _mnemonic = "";
      let _isEmbedded = window.parent !== window;

      function startCycle() {
        clearAllTimers();
        resetAll();
        document.getElementById("guideDoneOverlay").classList.remove("show");

        // â”€â”€ å ´æ™¯ Aï¼šæ²’äºº + èµ·å¸ = Go â”€â”€
        DOM.phaseLabel.textContent = "â”€â”€ æ²’äººï¼šèµ·å¸â†’æŒ‰ï¼â”€â”€";
        DOM.btnLabel.textContent = "è’é›†èµ·å¸";
        scheduleGo(0, DOM.cheese, SVG_CHEESE);
        schedule(() => updateProg(25, "go"), 4000);

        // â”€â”€ å ´æ™¯ Bï¼šæ²’äºº + è²“å’ª = NoGo â”€â”€
        schedule(() => {
          DOM.phaseLabel.textContent = "â”€â”€ æ²’äººï¼šè²“å’ªâ†’ä¸æŒ‰ï¼â”€â”€";
        }, 5000);
        scheduleNoGo(5000, DOM.cat, SVG_CAT);
        schedule(() => updateProg(50, "nogo"), 9000);

        // â”€â”€ å ´æ™¯ Cï¼šæœ‰äºº + è²“å’ª = Goï¼ˆè¦å‰‡åè½‰ï¼ï¼‰ â”€â”€
        schedule(() => {
          showPerson();
          DOM.phaseLabel.textContent = "â”€â”€ æœ‰äººï¼šè²“å’ªâ†’æŒ‰ï¼â”€â”€";
          DOM.btnLabel.textContent = "è’é›†";
        }, 10000);
        scheduleGo(10000, DOM.cat, SVG_CAT);
        schedule(() => updateProg(75, "go"), 14000);

        // â”€â”€ å ´æ™¯ Dï¼šæœ‰äºº + èµ·å¸ = NoGoï¼ˆè¦å‰‡åè½‰ï¼ï¼‰ â”€â”€
        schedule(() => {
          DOM.phaseLabel.textContent = "â”€â”€ æœ‰äººï¼šèµ·å¸â†’ä¸æŒ‰ï¼â”€â”€";
        }, 15000);
        scheduleNoGo(15000, DOM.cheese, SVG_CHEESE);
        schedule(() => updateProg(100, "nogo"), 19000);

        // æ¸…å ´
        schedule(() => {
          hidePerson();
          DOM.phaseLabel.textContent = "";
        }, 20000);

        // ä¸€è¼ªçµæŸå¾Œé¡¯ç¤ºæ§åˆ¶è¦†è“‹
        schedule(() => showDoneOverlay(), TOTAL);
      }

      function showDoneOverlay() {
        clearAllTimers();
        resetAll();
        const ov = document.getElementById("guideDoneOverlay");
        const mn = document.getElementById("guideDoneMnemonic");
        mn.textContent = _mnemonic || "ï¼ˆå£è¨£è¼‰å…¥ä¸­â€¦ï¼‰";
        ov.classList.add("show");
      }

      document.addEventListener("DOMContentLoaded", function () {
        document
          .getElementById("btnGuideReady")
          .addEventListener("click", function () {
            clearAllTimers();
            if (_isEmbedded)
              window.parent.postMessage({ type: "guide-ready" }, "*");
          });
        document
          .getElementById("btnGuideReplay")
          .addEventListener("click", function () {
            startCycle();
          });
        document
          .getElementById("btnGuideSkip")
          .addEventListener("click", function () {
            clearAllTimers();
            if (_isEmbedded)
              window.parent.postMessage({ type: "guide-ready" }, "*");
          });
      });

      window.addEventListener("message", function (e) {
        if (e.data && e.data.type === "init") {
          _mnemonic = e.data.mnemonic || "";
          var banner = document.getElementById("mnemonicBanner");
          if (_mnemonic) {
            banner.textContent = _mnemonic;
            banner.style.display = "block";
          }
          document.getElementById("btnGuideSkip").style.display = "block";
        }
        if (e.data && e.data.type === "stop") {
          clearAllTimers();
        }
      });

      function init() {
        DOM.bgLayer.innerHTML = SVG_MOUSE_HOLE;
        DOM.handFinger.innerHTML = SVG_FINGER_TAP;
        DOM.handStop.innerHTML = SVG_HAND_STOP;
        startCycle();
      }
      document.addEventListener("DOMContentLoaded", init);
    </script>
  </body>
</html>
