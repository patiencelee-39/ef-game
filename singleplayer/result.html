<!doctype html>
<html lang="zh-TW" data-theme="field-primary">
  <head>
    <meta charset="UTF-8" />
    <link rel="preconnect" href="https://www.googleapis.com" crossorigin />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no"
    />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; media-src 'self'; connect-src 'self' https://*.firebaseio.com https://*.googleapis.com wss://*.firebaseio.com https://*.firebasedatabase.app wss://*.firebasedatabase.app"
    />
    <title>遊戲結算</title>
    <link rel="icon" href="../favicon.svg" type="image/svg+xml" />
    <link rel="apple-touch-icon" href="../favicon.svg" />
    <link rel="manifest" href="../manifest.json" />
    <meta name="theme-color" content="#302b63" />

    <!-- CSS 載入順序：base → main → 本頁行內 -->
    <link rel="stylesheet" href="../css/themes/base.css" />
    <link rel="stylesheet" href="../css/main.css" />
    <link
      rel="preload"
      href="../css/components/csv-report.css"
      as="style"
      onload="this.rel = 'stylesheet'"
    />
    <noscript
      ><link rel="stylesheet" href="../css/components/csv-report.css"
    /></noscript>
    <link
      rel="preload"
      href="../css/components/landscape-hint.css"
      as="style"
      onload="this.rel = 'stylesheet'"
    />
    <noscript
      ><link rel="stylesheet" href="../css/components/landscape-hint.css"
    /></noscript>
    <link rel="stylesheet" href="../css/pages/result.css" />
    <link
      rel="preload"
      href="../css/components/navbar.css"
      as="style"
      onload="this.rel = 'stylesheet'"
    />
    <noscript
      ><link rel="stylesheet" href="../css/components/navbar.css"
    /></noscript>
    <!-- ==================== 模組載入 ==================== -->
    <!-- Firebase Bundle -->
    <script defer src="../js/firebase-bundle.js"></script>
    <!-- ==================== 遊戲核心 ==================== -->
    <script defer src="../js/game-config.js"></script>
    <script defer src="../js/adventure-maps-config.js"></script>
    <script defer src="../js/utils/storage.js"></script>
    <script defer src="../js/utils/score-calculator.js"></script>
    <script defer src="../js/utils/level-calculator.js"></script>
    <script defer src="../js/utils/badge-checker.js"></script>
    <script defer src="../js/sound-config.js"></script>
    <script defer src="../js/shared/audio-player.js"></script>
    <script defer src="../js/singleplayer/progress-tracker.js"></script>
    <script defer src="../js/singleplayer/mode-controller.js"></script>
    <!-- ==================== 分析報告依賴 ==================== -->
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"
    ></script>
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"
    ></script>
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/html2pdf.js@0.10.1/dist/html2pdf.bundle.min.js"
    ></script>
    <script defer src="../js/utils/constants.js"></script>
    <script defer src="../js/shared/csv-report.js"></script>
    <script defer src="../js/shared/leaderboard-writer.js"></script>
    <script defer src="../js/shared/firestore-leaderboard.js"></script>
    <script defer src="../js/shared/navbar.js"></script>
    <script defer src="../js/shared/landscape-hint.js"></script>
  </head>

  <body>
    <main class="result-page" id="main-content">
      <!-- === 頂部 === -->
      <div class="result-header">
        <h1 id="resultHeaderTitle">遊戲結算</h1>
      </div>

      <!-- === 主內容（動態填入）=== -->
      <div class="result-body" id="resultBody">
        <div
          style="text-align: center; padding: 48px; color: var(--text-light)"
        >
          載入結算資料中…
        </div>
      </div>

      <!-- === 底部按鈕 === -->
      <div class="result-actions" id="resultActions"></div>
    </main>

    <!-- ==================== 結算控制器 ==================== -->
    <script defer src="../js/singleplayer/result-controller.js"></script>
  </body>
</html>
