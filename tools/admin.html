<!doctype html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self' blob:; script-src 'self' 'unsafe-inline' https://*.firebasedatabase.app https://*.firebaseio.com; style-src 'self' 'unsafe-inline'; img-src 'self' data:; connect-src 'self' https://*.firebaseio.com https://*.googleapis.com wss://*.firebaseio.com https://*.firebasedatabase.app wss://*.firebasedatabase.app"
    />
    <title>ğŸ› ï¸ é–‹ç™¼è€…èˆ‡ç ”ç©¶è€…å·¥å…· - EF Game</title>
    <link rel="icon" href="../favicon.svg" type="image/svg+xml" />
    <link rel="stylesheet" href="../css/themes/base.css" />
    <link rel="stylesheet" href="../css/main.css" />
    <link
      rel="preload"
      href="../css/components/navbar.css"
      as="style"
      onload="this.rel = 'stylesheet'"
    />
    <noscript
      ><link rel="stylesheet" href="../css/components/navbar.css"
    /></noscript>
    <style>
      /* ======================== */
      /*  é–‹ç™¼è€…å·¥å…·é é¢æ¨£å¼       */
      /* ======================== */
      body {
        background: linear-gradient(
          135deg,
          #1a1a2e 0%,
          #16213e 50%,
          #0f3460 100%
        );
        min-height: 100vh;
        color: #e0e0e0;
        font-family: var(--font-family-main, "Noto Sans TC", sans-serif);
      }
      .dev-page {
        max-width: 800px;
        margin: 0 auto;
        padding: 24px 16px 60px;
      }
      .dev-page h1 {
        text-align: center;
        margin-bottom: 4px;
        font-size: 1.5rem;
      }
      .dev-subtitle {
        text-align: center;
        color: #aaa;
        font-size: 0.85rem;
        margin-bottom: 24px;
      }
      .dev-warning {
        background: rgba(255, 100, 100, 0.1);
        border: 1px solid rgba(255, 100, 100, 0.3);
        border-radius: 12px;
        padding: 12px 16px;
        margin-bottom: 24px;
        font-size: 0.85rem;
        line-height: 1.5;
        text-align: center;
      }
      .auth-status {
        text-align: center;
        margin-bottom: 16px;
        font-size: 0.8rem;
      }
      .dev-section {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 16px;
        padding: 20px;
        margin-bottom: 20px;
      }
      .dev-section h2 {
        font-size: 1.1rem;
        margin: 0 0 12px;
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .dev-section h2 .badge {
        font-size: 0.7rem;
        background: rgba(255, 255, 255, 0.1);
        padding: 2px 8px;
        border-radius: 20px;
        font-weight: normal;
        color: #aaa;
      }
      .data-list {
        max-height: 300px;
        overflow-y: auto;
        margin-bottom: 12px;
      }
      .data-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 10px 12px;
        margin-bottom: 6px;
        background: rgba(255, 255, 255, 0.03);
        border-radius: 10px;
        font-size: 0.85rem;
        gap: 8px;
      }
      .data-item .info {
        flex: 1;
        min-width: 0;
      }
      .data-item .info .name {
        font-weight: 600;
        color: #fff;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      .data-item .info .meta {
        font-size: 0.75rem;
        color: #888;
        margin-top: 2px;
      }
      .data-item .btn-delete {
        background: rgba(255, 80, 80, 0.15);
        border: 1px solid rgba(255, 80, 80, 0.3);
        color: #ff6b6b;
        border-radius: 8px;
        padding: 6px 12px;
        cursor: pointer;
        font-size: 0.8rem;
        white-space: nowrap;
        transition: all 0.2s;
      }
      .data-item .btn-delete:hover {
        background: rgba(255, 80, 80, 0.3);
      }
      .data-item input[type="checkbox"] {
        width: 18px;
        height: 18px;
        cursor: pointer;
        flex-shrink: 0;
      }
      .btn-row {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
      }
      .btn-action {
        flex: 1;
        min-width: 120px;
        padding: 10px 16px;
        border-radius: 10px;
        border: none;
        cursor: pointer;
        font-size: 0.85rem;
        transition: all 0.2s;
      }
      .btn-action:disabled {
        opacity: 0.4;
        cursor: not-allowed;
      }
      .btn-refresh {
        background: rgba(100, 180, 255, 0.15);
        border: 1px solid rgba(100, 180, 255, 0.3);
        color: #64b5f6;
      }
      .btn-refresh:hover:not(:disabled) {
        background: rgba(100, 180, 255, 0.3);
      }
      .btn-danger {
        background: rgba(255, 80, 80, 0.15);
        border: 1px solid rgba(255, 80, 80, 0.3);
        color: #ff6b6b;
      }
      .btn-danger:hover:not(:disabled) {
        background: rgba(255, 80, 80, 0.3);
      }
      .btn-back {
        display: inline-block;
        color: #aaa;
        text-decoration: none;
        font-size: 0.85rem;
        margin-bottom: 16px;
      }
      .btn-back:hover {
        color: #fff;
      }
      .empty {
        text-align: center;
        color: #666;
        padding: 20px;
        font-size: 0.85rem;
      }
      .log-area {
        background: rgba(0, 0, 0, 0.3);
        border-radius: 10px;
        padding: 12px;
        font-family: monospace;
        font-size: 0.8rem;
        max-height: 200px;
        overflow-y: auto;
        line-height: 1.6;
        margin-top: 12px;
      }
      .log-area .log-ok {
        color: #81c784;
      }
      .log-area .log-err {
        color: #ff6b6b;
      }
      .log-area .log-info {
        color: #64b5f6;
      }
      .select-all-row {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 12px;
        font-size: 0.8rem;
        color: #aaa;
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        margin-bottom: 6px;
      }
      /* ======================== */
      /*  ç ”ç©¶è€…å·¥å…·æ¨£å¼           */
      /* ======================== */
      .section-divider {
        text-align: center;
        margin: 36px 0 24px;
        position: relative;
      }
      .section-divider::before {
        content: "";
        position: absolute;
        top: 50%;
        left: 0;
        right: 0;
        height: 1px;
        background: rgba(255, 255, 255, 0.1);
      }
      .section-divider span {
        position: relative;
        background: #16213e;
        padding: 0 16px;
        font-size: 1rem;
        color: #4db6ac;
        font-weight: 600;
      }
      .tool-card {
        flex: 1;
        min-width: 200px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
        padding: 24px 16px;
        background: rgba(77, 182, 172, 0.08);
        border: 1px solid rgba(77, 182, 172, 0.2);
        border-radius: 16px;
        text-decoration: none;
        color: #e0e0e0;
        transition: all 0.25s;
        text-align: center;
      }
      .tool-card:hover {
        background: rgba(77, 182, 172, 0.18);
        border-color: rgba(77, 182, 172, 0.4);
        transform: translateY(-2px);
      }
      .tool-card-icon {
        font-size: 2.2rem;
      }
      .tool-card-title {
        font-size: 1rem;
        font-weight: 700;
        color: #fff;
      }
      .tool-card-desc {
        font-size: 0.78rem;
        color: #aaa;
      }
    </style>
  </head>
  <body>
    <div class="dev-page">
      <a class="btn-back" href="../settings/index.html">â† è¿”å›è¨­å®š</a>
      <h1>ğŸ› ï¸ é–‹ç™¼è€…èˆ‡ç ”ç©¶è€…å·¥å…·</h1>
      <p class="dev-subtitle">
        Firebase è³‡æ–™ç®¡ç† Â· æˆ¿é–“æ¸…ç† Â· æ’è¡Œæ¦œç®¡ç† Â· ç ”ç©¶è§€å¯Ÿå·¥å…·
      </p>

      <div class="dev-warning">
        âš ï¸
        æ­¤é é¢åƒ…ä¾›é–‹ç™¼è€…ä½¿ç”¨ã€‚åˆªé™¤æ“ä½œ<strong>ä¸å¯å¾©åŸ</strong>ï¼Œè«‹ç¢ºèªå¾Œå†æ“ä½œã€‚
      </div>

      <div class="auth-status" id="authStatus">â³ é€£ç·šä¸­â€¦</div>

      <!-- ===== 1. å¤šäººæˆ¿é–“ (RTDB) ===== -->
      <div class="dev-section">
        <h2>ğŸ  å¤šäººç«¶è³½æˆ¿é–“ <span class="badge" id="roomCount">0 ç­†</span></h2>
        <div class="data-list" id="roomList">
          <div class="empty">è¼‰å…¥ä¸­â€¦</div>
        </div>
        <div class="btn-row">
          <button class="btn-action btn-refresh" id="btnRefreshRooms">
            ğŸ”„ é‡æ–°æ•´ç†
          </button>
          <button
            class="btn-action btn-danger"
            id="btnDeleteSelectedRooms"
            disabled
          >
            ğŸ—‘ï¸ åˆªé™¤å‹¾é¸
          </button>
          <button class="btn-action btn-danger" id="btnDeleteAllRooms">
            ğŸ’£ æ¸…ç©ºå…¨éƒ¨æˆ¿é–“
          </button>
        </div>
      </div>

      <!-- ===== 2. ç­ç´šçœ‹æ¿ (Firestore) ===== -->
      <div class="dev-section">
        <h2>ğŸ“š ç­ç´šçœ‹æ¿ <span class="badge" id="boardCount">0 ç­†</span></h2>
        <div class="data-list" id="boardList">
          <div class="empty">è¼‰å…¥ä¸­â€¦</div>
        </div>
        <div class="btn-row">
          <button class="btn-action btn-refresh" id="btnRefreshBoards">
            ğŸ”„ é‡æ–°æ•´ç†
          </button>
          <button
            class="btn-action btn-danger"
            id="btnDeleteSelectedBoards"
            disabled
          >
            ğŸ—‘ï¸ åˆªé™¤å‹¾é¸
          </button>
          <button class="btn-action btn-danger" id="btnDeleteAllBoards">
            ğŸ’£ æ¸…ç©ºå…¨éƒ¨çœ‹æ¿
          </button>
        </div>
      </div>

      <!-- ===== 3. ä¸–ç•Œæ’è¡Œæ¦œ (Firestore) ===== -->
      <div class="dev-section">
        <h2>ğŸŒ ä¸–ç•Œæ’è¡Œæ¦œ <span class="badge" id="worldCount">0 ç­†</span></h2>
        <div class="data-list" id="worldList">
          <div class="empty">è¼‰å…¥ä¸­â€¦</div>
        </div>
        <div class="btn-row">
          <button class="btn-action btn-refresh" id="btnRefreshWorld">
            ğŸ”„ é‡æ–°æ•´ç†
          </button>
          <button
            class="btn-action btn-danger"
            id="btnDeleteSelectedWorld"
            disabled
          >
            ğŸ—‘ï¸ åˆªé™¤å‹¾é¸
          </button>
          <button class="btn-action btn-danger" id="btnDeleteAllWorld">
            ğŸ’£ æ¸…ç©ºä¸–ç•Œæ’è¡Œæ¦œ
          </button>
          <button
            class="btn-action btn-refresh"
            id="btnTrimWorld"
            style="
              background: rgba(255, 180, 50, 0.15);
              border-color: rgba(255, 180, 50, 0.3);
              color: #ffb432;
            "
          >
            âœ‚ï¸ ä¿®å‰ªè‡³å‰ 10 å
          </button>
        </div>
      </div>

      <!-- ===== 4. æœ¬æ©Ÿå¿«å–æ¸…é™¤ ===== -->
      <div class="dev-section">
        <h2>ğŸ§¹ æœ¬æ©Ÿå¿«å–ä¸€éµæ¸…é™¤</h2>
        <p style="font-size: 0.82rem; color: #aaa; margin-bottom: 12px">
          æ¸…é™¤ç•¶å‰ç€è¦½å™¨ä¸­ EF-Game çš„ localStorageã€sessionStorage èˆ‡ Service
          Worker å¿«å–ã€‚
        </p>
        <div class="btn-row" style="margin-bottom: 8px">
          <button class="btn-action btn-danger" id="btnClearLocal">
            ğŸ—‘ï¸ localStorage
          </button>
          <button class="btn-action btn-danger" id="btnClearSession">
            ğŸ—‘ï¸ sessionStorage
          </button>
          <button class="btn-action btn-danger" id="btnClearSwCache">
            ğŸ—‘ï¸ SW å¿«å–
          </button>
        </div>
        <div class="btn-row">
          <button
            class="btn-action btn-danger"
            id="btnClearAll"
            style="flex: 1; font-weight: 700; font-size: 0.95rem; padding: 12px"
          >
            ğŸ’£ ä¸€éµå…¨éƒ¨æ¸…é™¤ï¼ˆlocalStorage + sessionStorage + SW å¿«å–ï¼‰
          </button>
        </div>
        <div class="log-area" id="cacheLog" style="margin-top: 10px">
          <span class="log-info">ç­‰å¾…æ“ä½œâ€¦</span>
        </div>
      </div>

      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <!-- ğŸ“‹ ç ”ç©¶è€…å·¥å…·                       -->
      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <div class="section-divider">
        <span>ğŸ“‹ ç ”ç©¶è€…å·¥å…·</span>
      </div>

      <div style="display: flex; gap: 14px; flex-wrap: wrap; margin-bottom: 20px">
        <a href="guide-observation.html" class="tool-card">
          <span class="tool-card-icon">ğŸ“‹</span>
          <span class="tool-card-title">æ¸¬è©¦ç•¶å¤©å¼•å°æµç¨‹ï¼‹è§€å¯Ÿç´€éŒ„è¡¨</span>
          <span class="tool-card-desc">æ¨™æº–åŒ–å¼•å°æµç¨‹ Â· è§€å¯Ÿç´€éŒ„ Â· æ•¸æ“šåŒ¯å‡º</span>
        </a>
        <a href="multiplayer-checklist.html" class="tool-card">
          <span class="tool-card-icon">âœ…</span>
          <span class="tool-card-title">å¤šäººç«¶è³½æ¸¬è©¦ Check List</span>
          <span class="tool-card-desc">å¤šäººæ¨¡å¼å®Œæ•´æ¸¬è©¦æµç¨‹ Â· é€é …ç¢ºèª</span>
        </a>
      </div>

      <!-- ===== æ“ä½œè¨˜éŒ„ ===== -->
      <div class="dev-section">
        <h2>ğŸ“‹ æ“ä½œè¨˜éŒ„</h2>
        <div class="log-area" id="logArea">
          <span class="log-info">ç­‰å¾…æ“ä½œâ€¦</span>
        </div>
      </div>
    </div>

    <script defer src="../js/shared/navbar.js"></script>
    <script src="../js/firebase-bundle.js"></script>
    <script src="../js/shared/firestore-leaderboard.js"></script>
    <script src="admin-controller.js"></script>
  </body>
</html>
